<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="dns-prefetch" href="http://swsmile.info">
  <title>ã€Redisã€‘Redis High-availability | è¥¿ç»´èœ€é» çš„åšå®¢</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Redisé›†ç¾¤å½“é¢å¯¹ä¸€ä¸ªå°å‹çš„Demoé¡¹ç›®æ—¶ï¼Œä½¿ç”¨ä¸€å°RedisæœåŠ¡å™¨å·±ç»éå¸¸è¶³å¤Ÿäº†ï¼Œç„¶è€Œç°å®ä¸­çš„é¡¹ç›®é€šå¸¸éœ€è¦è‹¥å¹²å°RedisæœåŠ¡å™¨çš„æ”¯æŒï¼š  ä»ç»“æ„ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨ä¼šå‘ç”Ÿå•ç‚¹æ•…éšœï¼ŒåŒæ—¶ä¸€å°æœåŠ¡å™¨éœ€è¦æ‰¿å—æ‰€æœ‰çš„è¯·æ±‚è´Ÿè½½ã€‚è¿™å°±éœ€è¦ä¸ºæ•°æ®ç”Ÿæˆå¤šä¸ªå‰¯æœ¬å¹¶åˆ†é…åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼š ä»å®¹é‡ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨çš„å†…å­˜éå¸¸å®¹æ˜“æˆä¸ºå­˜å‚¨ç“¶é¢ˆï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œæ•°æ®åˆ†ç‰‡ã€‚  åŒæ—¶æ‹¥æœ‰å¤šä¸ªRedisæœåŠ¡å™¨åå°±ä¼šé¢">
<meta name="keywords" content="Redis">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€Redisã€‘Redis High-availability">
<meta property="og:url" content="http://swsmile.info/2020/05/07/ã€Redisã€‘Redis-é«˜å¯ç”¨/index.html">
<meta property="og:site_name" content="è¥¿ç»´èœ€é» çš„åšå®¢">
<meta property="og:description" content="Redisé›†ç¾¤å½“é¢å¯¹ä¸€ä¸ªå°å‹çš„Demoé¡¹ç›®æ—¶ï¼Œä½¿ç”¨ä¸€å°RedisæœåŠ¡å™¨å·±ç»éå¸¸è¶³å¤Ÿäº†ï¼Œç„¶è€Œç°å®ä¸­çš„é¡¹ç›®é€šå¸¸éœ€è¦è‹¥å¹²å°RedisæœåŠ¡å™¨çš„æ”¯æŒï¼š  ä»ç»“æ„ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨ä¼šå‘ç”Ÿå•ç‚¹æ•…éšœï¼ŒåŒæ—¶ä¸€å°æœåŠ¡å™¨éœ€è¦æ‰¿å—æ‰€æœ‰çš„è¯·æ±‚è´Ÿè½½ã€‚è¿™å°±éœ€è¦ä¸ºæ•°æ®ç”Ÿæˆå¤šä¸ªå‰¯æœ¬å¹¶åˆ†é…åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼š ä»å®¹é‡ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨çš„å†…å­˜éå¸¸å®¹æ˜“æˆä¸ºå­˜å‚¨ç“¶é¢ˆï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œæ•°æ®åˆ†ç‰‡ã€‚  åŒæ—¶æ‹¥æœ‰å¤šä¸ªRedisæœåŠ¡å™¨åå°±ä¼šé¢">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://d326g9ccfagnrm.cloudfront.net/img/assets/image-20200712141929372.png">
<meta property="og:image" content="https://d326g9ccfagnrm.cloudfront.net/img/assets/0*fONf9qdXjpC-b444.png">
<meta property="og:image" content="https://d326g9ccfagnrm.cloudfront.net/img/assets/ee2707c6204aa8a5f4d7adce4ad52873.jpg">
<meta property="og:image" content="https://d326g9ccfagnrm.cloudfront.net/img/assets/image-20190118123456671.png">
<meta property="og:image" content="https://d326g9ccfagnrm.cloudfront.net/img/assets/image-20190118123728988.png">
<meta property="og:image" content="https://d326g9ccfagnrm.cloudfront.net/img/assets/image-20190101200434738-6344274.png">
<meta property="og:updated_time" content="2020-07-28T13:41:17.979Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ã€Redisã€‘Redis High-availability">
<meta name="twitter:description" content="Redisé›†ç¾¤å½“é¢å¯¹ä¸€ä¸ªå°å‹çš„Demoé¡¹ç›®æ—¶ï¼Œä½¿ç”¨ä¸€å°RedisæœåŠ¡å™¨å·±ç»éå¸¸è¶³å¤Ÿäº†ï¼Œç„¶è€Œç°å®ä¸­çš„é¡¹ç›®é€šå¸¸éœ€è¦è‹¥å¹²å°RedisæœåŠ¡å™¨çš„æ”¯æŒï¼š  ä»ç»“æ„ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨ä¼šå‘ç”Ÿå•ç‚¹æ•…éšœï¼ŒåŒæ—¶ä¸€å°æœåŠ¡å™¨éœ€è¦æ‰¿å—æ‰€æœ‰çš„è¯·æ±‚è´Ÿè½½ã€‚è¿™å°±éœ€è¦ä¸ºæ•°æ®ç”Ÿæˆå¤šä¸ªå‰¯æœ¬å¹¶åˆ†é…åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼š ä»å®¹é‡ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨çš„å†…å­˜éå¸¸å®¹æ˜“æˆä¸ºå­˜å‚¨ç“¶é¢ˆï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œæ•°æ®åˆ†ç‰‡ã€‚  åŒæ—¶æ‹¥æœ‰å¤šä¸ªRedisæœåŠ¡å™¨åå°±ä¼šé¢">
<meta name="twitter:image" content="https://d326g9ccfagnrm.cloudfront.net/img/assets/image-20200712141929372.png">
  
    <link rel="alternative" href="/atom.xml" title="è¥¿ç»´èœ€é» çš„åšå®¢" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.2d7529.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    // listen to any DOM change and automatically perform spacing via MutationObserver()
    pangu.autoSpacingPage();
  });
</script>
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-78769787-2', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
<script>
var _hmt = _hmt || [];
(function() {
	var hm = document.createElement("script");
	hm.src = "https://hm.baidu.com/hm.js?4481376a6b117446f0ad6f2b9b796afc";
	var s = document.getElementsByTagName("script")[0]; 
	s.parentNode.insertBefore(hm, s);
})();
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->



</head>
</html>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/logo.jpg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">è¥¿ç»´èœ€é»</a></h1>
		</hgroup>
		
		<p class="header-subtitle">ğŸ’ Software engineer | ğŸ“·Photographer | ğŸ‘¹Urban explorer</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">ä¸»é¡µ</a></li>
	        
				<li><a href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">Tag</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">Friends</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="mail" target="_blank" href="mailto:swsmile1028@gmail.com" title="mail"><i class="icon-mail"></i></a>
		        
					<a class="github" target="_blank" href="https://github.com/swsmile" title="github"><i class="icon-github"></i></a>
		        
					<a class="linkedin" target="_blank" href="https://www.linkedin.com/in/weishi1028/" title="linkedin"><i class="icon-linkedin"></i></a>
		        
					<a class="weibo" target="_blank" href="https://weibo.com/swsmile666" title="weibo"><i class="icon-weibo"></i></a>
		        
					<a class="facebook" target="_blank" href="https://www.facebook.com/swsmile666" title="facebook"><i class="icon-facebook"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/logo.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">è¥¿ç»´èœ€é»</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>ğŸ’ Software engineer | ğŸ“·Photographer | ğŸ‘¹Urban explorer<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="mail" target="_blank" href="mailto:swsmile1028@gmail.com" title="mail"><i class="icon-mail"></i></a>
			        
						<a class="github" target="_blank" href="https://github.com/swsmile" title="github"><i class="icon-github"></i></a>
			        
						<a class="linkedin" target="_blank" href="https://www.linkedin.com/in/weishi1028/" title="linkedin"><i class="icon-linkedin"></i></a>
			        
						<a class="weibo" target="_blank" href="https://weibo.com/swsmile666" title="weibo"><i class="icon-weibo"></i></a>
			        
						<a class="facebook" target="_blank" href="https://www.facebook.com/swsmile666" title="facebook"><i class="icon-facebook"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 50%">
				
				
					<li style="width: 50%"><a href="/">ä¸»é¡µ</a></li>
		        
					<li style="width: 50%"><a href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            <article id="post-ã€Redisã€‘Redis-é«˜å¯ç”¨" class="article article-type-post " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ã€Redisã€‘Redis High-availability
    </h1>
  

        
        <a href="/2020/05/07/ã€Redisã€‘Redis-é«˜å¯ç”¨/" class="archive-article-date">
  	<time datetime="2020-05-07T09:16:56.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2020-05-07</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Redisé›†ç¾¤"><a href="#Redisé›†ç¾¤" class="headerlink" title="Redisé›†ç¾¤"></a>Redisé›†ç¾¤</h1><p>å½“é¢å¯¹ä¸€ä¸ªå°å‹çš„Demoé¡¹ç›®æ—¶ï¼Œä½¿ç”¨ä¸€å°RedisæœåŠ¡å™¨å·±ç»éå¸¸è¶³å¤Ÿäº†ï¼Œç„¶è€Œç°å®ä¸­çš„é¡¹ç›®é€šå¸¸éœ€è¦è‹¥å¹²å°RedisæœåŠ¡å™¨çš„æ”¯æŒï¼š</p>
<ul>
<li>ä»ç»“æ„ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨ä¼šå‘ç”Ÿå•ç‚¹æ•…éšœï¼ŒåŒæ—¶ä¸€å°æœåŠ¡å™¨éœ€è¦æ‰¿å—æ‰€æœ‰çš„è¯·æ±‚è´Ÿè½½ã€‚è¿™å°±éœ€è¦ä¸ºæ•°æ®ç”Ÿæˆå¤šä¸ªå‰¯æœ¬å¹¶åˆ†é…åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼š</li>
<li>ä»å®¹é‡ä¸Šï¼Œå•ä¸ªRedisæœåŠ¡å™¨çš„å†…å­˜éå¸¸å®¹æ˜“æˆä¸ºå­˜å‚¨ç“¶é¢ˆï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œæ•°æ®åˆ†ç‰‡ã€‚</li>
</ul>
<p>åŒæ—¶æ‹¥æœ‰å¤šä¸ªRedisæœåŠ¡å™¨åå°±ä¼šé¢ä¸´å¦‚ä½•ç®¡ç†é›†ç¾¤çš„é—®é¢˜ï¼ŒåŒ…æ‹¬å¦‚ä½•å¢åŠ èŠ‚ç‚¹ã€æ•…éšœæ¢å¤ç­‰æ“ä½œã€‚</p>
<p>ä¸ºæ­¤ï¼Œä¸‹æ–‡å°†ä¾æ¬¡è¯¦ç»†ä»‹ç»Redisä¸­çš„æ•°æ®åˆ†ç‰‡ï¼ˆdata shardingï¼‰ã€å¤åˆ¶ï¼ˆreplicationï¼‰ã€å“¨å…µï¼ˆsentinelï¼‰å’Œé›†ç¾¤ï¼ˆclusterï¼‰çš„ä½¿ç”¨å’ŒåŸç†ã€‚</p>
<a id="more"></a> 

<h1 id="æ•°æ®åˆ†ç‰‡ï¼ˆData-shardingï¼‰"><a href="#æ•°æ®åˆ†ç‰‡ï¼ˆData-shardingï¼‰" class="headerlink" title="æ•°æ®åˆ†ç‰‡ï¼ˆData shardingï¼‰"></a>æ•°æ®åˆ†ç‰‡ï¼ˆData shardingï¼‰</h1><h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>é•¿æœŸä»¥æ¥ï¼ŒRedis æœ¬èº«ä»…æ”¯æŒå•å®ä¾‹ï¼Œå†…å­˜ä¸€èˆ¬æœ€å¤š 10 ~ 20GBã€‚è¿™æ— æ³•æ”¯æ’‘å¤§å‹çº¿ä¸Šä¸šåŠ¡ç³»ç»Ÿçš„éœ€æ±‚ï¼ˆæ¯”å¦‚å½“åŒ11çš„æ—¶å€™ï¼Œå¯¹äºç¼“å­˜å®¹é‡çš„è¦æ±‚ï¼Œå¾€å¾€ä¼šè¿œé«˜äºå¹³æ—¥ï¼‰ã€‚è€Œä¸”ä¹Ÿé€ æˆèµ„æºçš„åˆ©ç”¨ç‡è¿‡ä½â€”â€”æ¯•ç«Ÿç°åœ¨æœåŠ¡å™¨å†…å­˜åŠ¨è¾„ 100 ~ 200GBã€‚</p>
<p>ä¸ºè§£å†³å•æœºæ‰¿è½½èƒ½åŠ›ä¸è¶³å’Œå¼¹æ€§è®¾ç½®å®¹é‡çš„é—®é¢˜ï¼Œæˆ‘ä»¬å°±æœ‰äº†å„ç§æ•°æ®åˆ†ç‰‡ï¼ˆdata shardingï¼‰æŠ€æœ¯ã€‚</p>
<p>ä¸‹é¢ä¸€ä¸€åšä»‹ç»ã€‚</p>
<h2 id="å®¢æˆ·ç«¯åˆ†ç‰‡ï¼ˆClient-Shardingï¼‰"><a href="#å®¢æˆ·ç«¯åˆ†ç‰‡ï¼ˆClient-Shardingï¼‰" class="headerlink" title="å®¢æˆ·ç«¯åˆ†ç‰‡ï¼ˆClient Shardingï¼‰"></a>å®¢æˆ·ç«¯åˆ†ç‰‡ï¼ˆClient Shardingï¼‰</h2><h3 id="ä¼ ç»Ÿçš„å®¢æˆ·ç«¯åˆ†ç‰‡"><a href="#ä¼ ç»Ÿçš„å®¢æˆ·ç«¯åˆ†ç‰‡" class="headerlink" title="ä¼ ç»Ÿçš„å®¢æˆ·ç«¯åˆ†ç‰‡"></a>ä¼ ç»Ÿçš„å®¢æˆ·ç«¯åˆ†ç‰‡</h3><p>è¿™ç§æ–¹æ¡ˆå°†åˆ†ç‰‡å·¥ä½œæ”¾åœ¨ä¸šåŠ¡ç¨‹åºç«¯ï¼Œç¨‹åºä»£ç æ ¹æ®é¢„å…ˆè®¾ç½®çš„è·¯ç”±è§„åˆ™ï¼ˆæ¯”å¦‚ï¼Œå¯¹key hashç„¶åæŒ‰ 10 å–æ¨¡ï¼Œç»“æœä¸º1åˆ™å­˜åˆ° Redis node1ï¼Œç»“æœä¸º2åˆ™å­˜åˆ°Redis node2ï¼Œä»¥æ­¤ç±»æ¨ï¼‰ï¼Œç›´æ¥å¯¹å¤šä¸ª Redis å®ä¾‹è¿›è¡Œåˆ†å¸ƒå¼è®¿é—®ã€‚</p>
<p>Java rediså®¢æˆ·ç«¯é©±åŠ¨ Jedisï¼Œæ”¯æŒRedis ShardingåŠŸèƒ½ï¼Œå³ShardedJedisä»¥åŠç»“åˆç¼“å­˜æ± çš„ShardedJedisPoolã€‚</p>
<p><img src="https://d326g9ccfagnrm.cloudfront.net/img/assets/image-20200712141929372.png" alt="image-20200712141929372"></p>
<p>è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œéå¸¸ç®€å•ï¼ŒæœåŠ¡ç«¯çš„Rediså®ä¾‹å½¼æ­¤ç‹¬ç«‹ï¼Œç›¸äº’æ— å…³è”ï¼Œæ¯ä¸ªRediså®ä¾‹åƒå•æœåŠ¡å™¨ä¸€æ ·è¿è¡Œï¼Œéå¸¸å®¹æ˜“çº¿æ€§æ‰©å±•ï¼Œç³»ç»Ÿçš„çµæ´»æ€§å¾ˆå¼ºã€‚å› ä¸ºå…¶ä¸ä¾èµ–äºç¬¬ä¸‰æ–¹åˆ†å¸ƒå¼ä¸­é—´ä»¶ï¼Œå®ç°æ–¹æ³•å’Œä»£ç éƒ½è‡ªå·±æŒæ§ï¼Œå¯éšæ—¶è°ƒæ•´ï¼Œä¸ç”¨æ‹…å¿ƒè¸©åˆ°å‘ã€‚</p>
<p>å¦å¤–ï¼Œè¿™ç§åˆ†ç‰‡æœºåˆ¶çš„æ€§èƒ½æ¯”ä»£ç†å¼æ›´å¥½ï¼ˆå°‘äº†ä¸€ä¸ªä¸­é—´åˆ†å‘ç¯èŠ‚ï¼‰ã€‚</p>
<p>è¿™å®é™…ä¸Šæ˜¯ä¸€ç§é™æ€åˆ†ç‰‡æŠ€æœ¯ã€‚Redis å®ä¾‹çš„å¢å‡ï¼Œéƒ½å¾—æ‰‹å·¥è°ƒæ•´åˆ†ç‰‡ç¨‹åºã€‚</p>
<p>å®¢æˆ·ç«¯shardingçš„åŠ£åŠ¿ä¹Ÿæ˜¯å¾ˆæ˜æ˜¾çš„ã€‚ç”±äºshardingå¤„ç†æ”¾åˆ°å®¢æˆ·ç«¯ï¼Œè§„æ¨¡è¿›ä¸€æ­¥æ‰©å¤§æ—¶ç»™è¿ç»´å¸¦æ¥æŒ‘æˆ˜ã€‚å®¢æˆ·ç«¯shardingä¸æ”¯æŒåŠ¨æ€å¢åˆ èŠ‚ç‚¹ã€‚æœåŠ¡ç«¯Rediså®ä¾‹ç¾¤æ‹“æ‰‘ç»“æ„æœ‰å˜åŒ–æ—¶ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯éƒ½éœ€è¦æ›´æ–°è°ƒæ•´ã€‚è¿æ¥ä¸èƒ½å…±äº«ï¼Œå½“åº”ç”¨è§„æ¨¡å¢å¤§æ—¶ï¼Œèµ„æºæµªè´¹åˆ¶çº¦ä¼˜åŒ–ã€‚</p>
<h3 id="æ–°ä¸€ä»£çš„å®¢æˆ·ç«¯åˆ†ç‰‡"><a href="#æ–°ä¸€ä»£çš„å®¢æˆ·ç«¯åˆ†ç‰‡" class="headerlink" title="æ–°ä¸€ä»£çš„å®¢æˆ·ç«¯åˆ†ç‰‡"></a>æ–°ä¸€ä»£çš„å®¢æˆ·ç«¯åˆ†ç‰‡</h3><p>Redis Clusterå¹¶éä½¿ç”¨Porxyæ¨¡å¼æ¥è¿æ¥é›†ç¾¤èŠ‚ç‚¹ï¼Œè€Œæ˜¯ä½¿ç”¨æ— ä¸­å¿ƒèŠ‚ç‚¹çš„æ¨¡å¼æ¥ç»„å»ºé›†ç¾¤ï¼ˆå³æ²¡æœ‰coordinatorï¼‰ã€‚</p>
<p><img src="https://d326g9ccfagnrm.cloudfront.net/img/assets/0*fONf9qdXjpC-b444.png" alt="Image for post"></p>
<p>è¿™æ„å‘³ç€ï¼Œclientè¿æ¥Redis Clusteræ—¶ï¼ŒRedis Clusteréœ€è¦å‘Šè¯‰clientä¸€ä¸ªç‰¹å®šçš„keyå­˜åœ¨å“ªä¸ªRedis master nodeã€‚</p>
<blockquote>
<p>There are 16384 hash slots in Redis Cluster, and to compute what is the hash slot of a given key, we simply take the CRC16 of the key modulo 16384.</p>
<p>æ¯ä¸ª key å­˜æ”¾åœ¨è¿™ 16384ï¼ˆ0ï½16383ï¼‰ ä¸ªå“ˆå¸Œæ§½ä¸­çš„å…¶ä¸­ä¸€ä¸ªï¼Œæ¯ä¸ªRedis node å­˜å‚¨ä¸€éƒ¨åˆ†å“ˆå¸Œæ§½ã€‚</p>
</blockquote>
<h2 id="ä»£ç†åˆ†ç‰‡ï¼ˆProxy-Shardingï¼‰"><a href="#ä»£ç†åˆ†ç‰‡ï¼ˆProxy-Shardingï¼‰" class="headerlink" title="ä»£ç†åˆ†ç‰‡ï¼ˆProxy Shardingï¼‰"></a>ä»£ç†åˆ†ç‰‡ï¼ˆProxy Shardingï¼‰</h2><p>è¿™ç§æ–¹æ¡ˆï¼Œå°†åˆ†ç‰‡å·¥ä½œäº¤ç»™ä¸“é—¨çš„ä»£ç†ç¨‹åºæ¥åšã€‚ä»£ç†ç¨‹åºæ¥æ”¶åˆ°æ¥è‡ªä¸šåŠ¡ç¨‹åºçš„æ•°æ®è¯·æ±‚ï¼Œæ ¹æ®è·¯ç”±è§„åˆ™ï¼Œå°†è¿™äº›è¯·æ±‚åˆ†å‘ç»™æ­£ç¡®çš„ Redis å®ä¾‹å¹¶è¿”å›ç»™ä¸šåŠ¡ç¨‹åºã€‚</p>
<p><img src="https://d326g9ccfagnrm.cloudfront.net/img/assets/ee2707c6204aa8a5f4d7adce4ad52873.jpg" alt="é«˜æ•ˆè¿ç»´æœ€ä½³å®è·µï¼ˆ03ï¼‰ï¼šRedisé›†ç¾¤æŠ€æœ¯åŠCodiså®è·µ"></p>
<p>è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œä¸šåŠ¡ç¨‹åºä¸ç”¨å…³å¿ƒåç«¯ Redis å®ä¾‹ï¼Œè¿ç»´èµ·æ¥ä¹Ÿæ–¹ä¾¿ã€‚è™½ç„¶ä¼šå› æ­¤å¸¦æ¥äº›æ€§èƒ½æŸè€—ï¼Œä½†å¯¹äº Redis è¿™ç§å†…å­˜è¯»å†™å‹åº”ç”¨ï¼Œç›¸å¯¹è€Œè¨€æ˜¯èƒ½å®¹å¿çš„ã€‚</p>
<p>è¿™æ˜¯æˆ‘ä»¬æ¨èçš„é›†ç¾¤å®ç°æ–¹æ¡ˆã€‚åŸºäºè¯¥æœºåˆ¶çš„å¼€æºäº§å“ï¼š Twemproxyã€Codisã€‚</p>
<h1 id="å¤åˆ¶ï¼ˆreplicationï¼‰"><a href="#å¤åˆ¶ï¼ˆreplicationï¼‰" class="headerlink" title="å¤åˆ¶ï¼ˆreplicationï¼‰"></a>å¤åˆ¶ï¼ˆreplicationï¼‰</h1><p>é€šè¿‡æŒä¹…åŒ–åŠŸèƒ½ï¼ŒRedisä¿è¯äº†å³ä½¿åœ¨æœåŠ¡å™¨é‡å¯çš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šæŸå¤±ï¼ˆæˆ–å°‘é‡æŸå¤±ï¼‰ æ•°æ®ã€‚ä½†æ˜¯ç”±äºæ•°æ®æ˜¯å­˜å‚¨åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šçš„ï¼Œå¦‚æœè¿™å°æœåŠ¡å™¨å‡ºç°ç¡¬ç›˜æ•…éšœç­‰é—®é¢˜ï¼Œä¹Ÿä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚</p>
<p>ä¸ºäº†é¿å…<strong>å•ç‚¹æ•…éšœ</strong>ï¼Œé€šå¸¸çš„åšæ³•æ˜¯å°†æ•°æ®åº“å¤åˆ¶å¤šä¸ªå‰¯æœ¬ä»¥éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·å³ä½¿æœ‰ä¸€å°æœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œå…¶ä»–æœåŠ¡å™¨ä¾ç„¶å¯ä»¥ç»§ç»­æä¾›æœåŠ¡ã€‚</p>
<p>ä¸ºæ­¤ï¼Œ Redisæä¾›äº†å¤åˆ¶ï¼ˆreplicationï¼‰åŠŸèƒ½ï¼Œå¯ä»¥å®ç°å½“Master Redis nodeä¸­çš„æ•°æ®æ›´æ–°åï¼ˆè¿›è¡Œäº†å†™æ“ä½œï¼‰ï¼Œè‡ªåŠ¨å°†æ›´æ–°çš„æ•°æ®åŒæ­¥åˆ°æ‰€æœ‰çš„Slave Redis nodeä¸Šã€‚ä½†ä¸æ”¯æŒä¸»ä¸»å¤åˆ¶ã€‚</p>
<p><img src="https://d326g9ccfagnrm.cloudfront.net/img/assets/image-20190118123456671.png" alt="image-20190118123456671"></p>
<p>See <a href="https://redis.io/topics/replication" target="_blank" rel="noopener">https://redis.io/topics/replication</a> for more details.</p>
<h2 id="ä¸€è‡´æ€§ä¿è¯ï¼ˆConsistency-Guaranteesï¼‰"><a href="#ä¸€è‡´æ€§ä¿è¯ï¼ˆConsistency-Guaranteesï¼‰" class="headerlink" title="ä¸€è‡´æ€§ä¿è¯ï¼ˆConsistency Guaranteesï¼‰"></a>ä¸€è‡´æ€§ä¿è¯ï¼ˆConsistency Guaranteesï¼‰</h2><p>Synchronous replication of certain data can be requested by the clients using the <a href="https://redis.io/commands/wait" target="_blank" rel="noopener">WAIT</a> command. </p>
<p>However <a href="https://redis.io/commands/wait" target="_blank" rel="noopener">WAIT</a> is only able to ensure that there are the specified number of acknowledged copies in the other Redis instances, it does not turn a set of Redis instances into a CP system with strong consistency: acknowledged writes can still be lost during a failover, depending on the exact configuration of the Redis persistence. However with <a href="https://redis.io/commands/wait" target="_blank" rel="noopener">WAIT</a> the probability of losing a write after a failure event is greatly reduced to certain hard to trigger failure modes.</p>
<hr>
<p>Redis Cluster is not able to guarantee <strong>strong consistency</strong>. In practical terms this means that under certain conditions it is possible that Redis Cluster will lose writes that were acknowledged by the system to the client.</p>
<p>The first reason why Redis Cluster can lose writes is because it uses asynchronous replication. This means that during writes the following happens:</p>
<ul>
<li>Your client writes to the master B.</li>
<li>The master B replies OK to your client.</li>
<li>The master B propagates the write to its slaves B1, B2 and B3.</li>
</ul>
<p>As you can see, B does not wait for an acknowledgement from B1, B2, B3 before replying to the client, since this would be a prohibitive latency penalty for Redis, so if your client writes something, B acknowledges the write, but crashes before being able to send the write to its slaves, one of the slaves (that did not receive the write) can be promoted to master, losing the write forever.</p>
<p>See <a href="https://redis.io/topics/replication" target="_blank" rel="noopener">https://redis.io/topics/replication</a> for more details.</p>
<h2 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul>
<li><strong>é«˜å¯é æ€§</strong>ï¼šä¸€æ–¹é¢ï¼Œé‡‡ç”¨åŒæœº<strong>ä¸»å¤‡æ¶æ„ï¼ˆmaster-slave architectureï¼‰</strong>ï¼Œèƒ½å¤Ÿåœ¨ä¸»åº“å‡ºç°æ•…éšœæ—¶è‡ªåŠ¨è¿›è¡Œä¸»å¤‡åˆ‡æ¢ï¼Œä»åº“æå‡ä¸ºä¸»åº“æä¾›æœåŠ¡ï¼Œä¿è¯æœåŠ¡å¹³ç¨³è¿è¡Œï¼›å¦ä¸€æ–¹é¢ï¼Œå¼€å¯æ•°æ®æŒä¹…åŒ–åŠŸèƒ½å’Œé…ç½®åˆç†çš„å¤‡ä»½ç­–ç•¥ï¼Œèƒ½æœ‰æ•ˆçš„è§£å†³æ•°æ®è¯¯æ“ä½œå’Œæ•°æ®å¼‚å¸¸ä¸¢å¤±çš„é—®é¢˜ï¼›</li>
<li><strong>è¯»å†™åˆ†ç¦»ç­–ç•¥</strong>ï¼šä»èŠ‚ç‚¹å¯ä»¥æ‰©å±•ä¸»åº“èŠ‚ç‚¹çš„è¯»èƒ½åŠ›ï¼Œæœ‰æ•ˆåº”å¯¹å¤§å¹¶å‘é‡çš„è¯»æ“ä½œã€‚</li>
</ul>
<h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul>
<li><strong>æ•…éšœæ¢å¤ï¼ˆfailure recoveryï¼‰å¤æ‚</strong>ï¼Œå¦‚æœæ²¡æœ‰ RedisHA ç³»ç»Ÿï¼ˆéœ€è¦å¼€å‘ï¼‰ï¼Œå½“ master Redis node å‡ºç°æ•…éšœæ—¶ï¼Œéœ€è¦æ‰‹åŠ¨å°†ä¸€ä¸ª slave Redis node æ™‹å‡ä¸ºmaster Redis nodeï¼ŒåŒæ—¶éœ€è¦é€šçŸ¥ä¸šåŠ¡æ–¹å˜æ›´é…ç½®ï¼Œæ•´ä¸ªè¿‡ç¨‹éœ€è¦äººä¸ºå¹²é¢„ï¼Œæ¯”è¾ƒç¹çï¼›</li>
<li><strong>ä¸»åº“çš„å†™èƒ½åŠ›å—åˆ°å•æœºçš„é™åˆ¶</strong>ï¼Œå¯ä»¥è€ƒè™‘æ•°æ®åˆ†ç‰‡ï¼ˆdata shardingï¼‰ï¼Œå³å°†æ•°æ®åŸºäºä¸€å®šçš„è§„åˆ™ï¼ˆæ¯”å¦‚CRC16ï¼‰å­˜å‚¨åˆ°å¤šä¸ªRedis nodeä¸­ï¼›</li>
<li><strong>ä¸»åº“çš„å­˜å‚¨èƒ½åŠ›å—åˆ°å•æœºçš„é™åˆ¶</strong>ï¼ŒåŒæ ·å¯ä»¥è€ƒè™‘æ•°æ®åˆ†ç‰‡ï¼ˆdata shardingï¼‰ã€‚</li>
</ul>
<h1 id="å“¨å…µï¼ˆSentinelï¼‰-High-Availability"><a href="#å“¨å…µï¼ˆSentinelï¼‰-High-Availability" class="headerlink" title="å“¨å…µï¼ˆSentinelï¼‰- High Availability"></a>å“¨å…µï¼ˆSentinelï¼‰- High Availability</h1><h2 id="Background-1"><a href="#Background-1" class="headerlink" title="Background"></a>Background</h2><p>åœ¨ä¸€ä¸ªå…¸å‹çš„ä¸€ä¸»å¤šä»çš„Redisç³»ç»Ÿä¸­ï¼Œ Slava Redis Node åœ¨æ•´ä¸ªç³»ç»Ÿä¸­èµ·åˆ°äº†æ•°æ®å†—ä½™å¤‡ä»½å’Œè¯»å†™åˆ†ç¦»çš„ä½œç”¨ã€‚å½“ Master Redis Node é‡åˆ°å¼‚å¸¸ä¸­æ–­æœåŠ¡åï¼Œè¿ç»´äººå‘˜å¯ä»¥é€šè¿‡<strong>æ‰‹åŠ¨çš„æ–¹å¼</strong>é€‰æ‹©ä¸€ä¸ª Slava Redis Node æ¥å‡æ ¼ä¸ºMaster Redis Node ï¼Œä»¥ä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿç»§ç»­æä¾›æœåŠ¡ã€‚</p>
<p>ä¸ºæ­¤ï¼ŒRedis 2.8ä¸­æä¾›äº†å“¨å…µå·¥å…·æ¥å®ç°è‡ªåŠ¨åŒ–çš„ç³»ç»Ÿç›‘æ§å’Œæ•…éšœæ¢å¤åŠŸèƒ½ã€‚</p>
<p>é¡¾åæ€ä¹‰ï¼Œå“¨å…µçš„ä½œç”¨å°±æ˜¯ç›‘æ§Redisç³»ç»Ÿçš„è¿è¡ŒçŠ¶å†µã€‚å®ƒçš„åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li>ç›‘æ§Master Redis nodeå’ŒSlave Redis nodeæ˜¯å¦æ­£å¸¸è¿è¡Œï¼Œ</li>
<li>Master Redis nodeå‡ºç°æ•…éšœæ—¶è‡ªåŠ¨å°†Slave Redis nodeè½¬æ¢ä¸ºMaster Redis nodeã€‚</li>
</ul>
<h2 id="Redis-Sentinel"><a href="#Redis-Sentinel" class="headerlink" title="Redis Sentinel"></a>Redis Sentinel</h2><p>Redis Sentinel provides high availability for Redis. In practical terms this means that using Sentinel you can create a Redis deployment that resists without human intervention certain kinds of failures.</p>
<p>Redis Sentinel also provides other collateral tasks such as monitoring, notifications and acts as a configuration provider for clients.</p>
<p>This is the full list of Sentinel capabilities at a macroscopical level (i.e. the <em>big picture</em>):</p>
<ul>
<li><strong>Monitoring</strong>. Sentinel constantly checks if your master and replica instances are working as expected.</li>
<li><strong>Notification</strong>. Sentinel can notify the system administrator, or other computer programs, via an API, that something is wrong with one of the monitored Redis instances.</li>
<li><strong>Automatic failover</strong>. If a master is not working as expected, Sentinel can start a failover process where a replica is promoted to master, the other additional replicas are reconfigured to use the new master, and the applications using the Redis server are informed about the new address to use when connecting.</li>
<li><strong>Configuration provider</strong>. Sentinel acts as a source of authority for clients service discovery: clients connect to Sentinels in order to ask for the address of the current Redis master responsible for a given service. If a failover occurs, Sentinels will report the new address.</li>
</ul>
<p>See <a href="https://redis.io/topics/sentinel" target="_blank" rel="noopener">https://redis.io/topics/sentinel</a> for more details.</p>
<p>å“¨å…µæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä½¿ç”¨å“¨å…µçš„ä¸€ä¸ªå…¸å‹æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://d326g9ccfagnrm.cloudfront.net/img/assets/image-20190118123728988.png" alt="image-20190118123728988"></p>
<p>åœ¨ä¸€ä¸ªä¸€ä¸»å¤šä»çš„Redisç³»ç»Ÿä¸­ï¼Œå¯ä»¥ä½¿ç”¨<strong>å¤šä¸ªå“¨å…µ</strong>è¿›è¡Œç›‘æ§ä»»åŠ¡ä»¥ä¿è¯ç³»ç»Ÿè¶³å¤Ÿç¨³å¥ï¼Œ å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ³¨æ„ï¼Œæ­¤æ—¶ä¸ä»…å“¨å…µä¼šåŒæ—¶ç›‘æ§Master Redis nodeå’ŒSlave Redis nodeï¼Œå“¨å…µä¹‹é—´ä¹Ÿä¼šäº’ç›¸ç›‘æ§ã€‚</p>
<p><img src="https://d326g9ccfagnrm.cloudfront.net/img/assets/image-20190101200434738-6344274.png" alt="image-20190101200434738"></p>
<h2 id="ä¼˜ç¼ºç‚¹-1"><a href="#ä¼˜ç¼ºç‚¹-1" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h2><h3 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul>
<li>Redis Sentinel é›†ç¾¤éƒ¨ç½²ç®€å•ï¼›</li>
<li>èƒ½å¤Ÿè§£å†³ Redis ä¸»ä»æ¨¡å¼ä¸‹çš„é«˜å¯ç”¨åˆ‡æ¢é—®é¢˜ï¼›</li>
<li>å¾ˆæ–¹ä¾¿å®ç° Redis æ•°æ®èŠ‚ç‚¹çš„çº¿å½¢æ‰©å±•ï¼Œè½»æ¾çªç ´ Redis è‡ªèº«å•çº¿ç¨‹ç“¶é¢ˆï¼Œå¯æå¤§æ»¡è¶³ Redis å¤§å®¹é‡æˆ–é«˜æ€§èƒ½çš„ä¸šåŠ¡éœ€æ±‚ï¼›</li>
<li>å¯ä»¥å®ç°ä¸€å¥— Sentinel ç›‘æ§ä¸€ç»„ Redis æ•°æ®èŠ‚ç‚¹æˆ–å¤šç»„æ•°æ®èŠ‚ç‚¹ã€‚</li>
</ul>
<h3 id="ç¼ºç‚¹-1"><a href="#ç¼ºç‚¹-1" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul>
<li>éƒ¨ç½²ç›¸å¯¹ Redis ä¸»ä»æ¨¡å¼è¦å¤æ‚ä¸€äº›ï¼ŒåŸç†ç†è§£æ›´ç¹çï¼›</li>
<li>èµ„æºæµªè´¹ï¼ŒRedis æ•°æ®èŠ‚ç‚¹ä¸­ slave èŠ‚ç‚¹ä½œä¸ºå¤‡ä»½èŠ‚ç‚¹ä¸æä¾›æœåŠ¡ï¼›</li>
</ul>
<h1 id="Redis-Clusterï¼ˆRedis-é›†ç¾¤è§£å†³æ–¹æ¡ˆï¼‰-Redis-æ°´å¹³æ‰©å®¹"><a href="#Redis-Clusterï¼ˆRedis-é›†ç¾¤è§£å†³æ–¹æ¡ˆï¼‰-Redis-æ°´å¹³æ‰©å®¹" class="headerlink" title="Redis Clusterï¼ˆRedis é›†ç¾¤è§£å†³æ–¹æ¡ˆï¼‰ - Redis æ°´å¹³æ‰©å®¹"></a>Redis Clusterï¼ˆRedis é›†ç¾¤è§£å†³æ–¹æ¡ˆï¼‰ - Redis æ°´å¹³æ‰©å®¹</h1><p>å³ä½¿ä½¿ç”¨å“¨å…µï¼Œæ­¤æ—¶çš„Redisé›†ç¾¤çš„æ¯ä¸ªæ•°æ®åº“ä¾ç„¶å­˜æœ‰é›†ç¾¤ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œä»è€Œå¯¼è‡´<strong>é›†ç¾¤çš„æ€»æ•°æ®å­˜å‚¨é‡å—é™äºå¯ç”¨å­˜å‚¨å†…å­˜æœ€å°çš„æ•°æ®åº“èŠ‚ç‚¹</strong>ï¼Œå½¢æˆæœ¨æ¡¶æ•ˆåº”ã€‚ç”±äºRedis ä¸­çš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯åŸºäºå†…å­˜å­˜å‚¨ï¼Œè¿™ä¸€é—®é¢˜å°±å°¤ä¸ºçªå‡ºäº†ï¼Œå°¤å…¶æ˜¯å½“ä½¿ç”¨RedisåšæŒä¹…åŒ–å­˜å‚¨æœåŠ¡ä½¿ç”¨æ—¶ã€‚</p>
<p>å¯¹Redisè¿›è¡Œæ°´å¹³æ‰©å®¹ï¼ˆhorizential scalingï¼‰ï¼Œåœ¨æ—§ç‰ˆRedisä¸­é€šå¸¸ä½¿ç”¨å®¢æˆ·ç«¯åˆ†ç‰‡ï¼ˆclient Shardingï¼‰æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå³å¯åŠ¨å¤šä¸ªRedisæ•°æ®åº“èŠ‚ç‚¹ï¼Œç”±å®¢æˆ·ç«¯å†³å®šæ¯ä¸ª key äº¤ç”±å“ªä¸ª Redis node å­˜å‚¨ï¼Œä¸‹æ¬¡å®¢æˆ·ç«¯è¯»å–è¯¥ key æ—¶ï¼Œç›´æ¥åˆ°è¯¥èŠ‚ç‚¹è¯»å–å³å¯ã€‚</p>
<p>è¿™æ ·å¯ä»¥å®ç°å°†æ•´ä¸ªæ•°æ®åˆ†å¸ƒå­˜å‚¨åœ¨Nä¸ªRedis node ä¸­ï¼Œæ¯ä¸ª node åªå­˜æ”¾æ€»æ•°æ®é‡çš„1/Nã€‚</p>
<p>å¯¹äºéœ€è¦æ‰©å®¹çš„åœºæ™¯æ¥è¯´ï¼Œåœ¨å®¢æˆ·ç«¯åˆ†ç‰‡åï¼Œå¦‚æœæƒ³å¢åŠ æ›´å¤šçš„èŠ‚ç‚¹ï¼ˆè¿™æ˜¯å¾ˆæœ‰å¯èƒ½çš„ï¼Œæ¯”å¦‚æ•´ä¸ª Redis é›†ç¾¤çš„memory usageå¿«æ»¡äº†ï¼Œæˆ–è€…performance bottleneckï¼‰ï¼Œå°±éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ‰‹å·¥è¿ç§»ï¼ŒåŒæ—¶åœ¨è¿ç§»çš„è¿‡ç¨‹ä¸­ä¸ºäº†ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œ è¿˜éœ€è¦å°†é›†ç¾¤æš‚æ—¶ä¸‹çº¿ï¼Œç›¸å¯¹æ¯”è¾ƒå¤æ‚ã€‚</p>
<h2 id="Redis-Cluster-data-sharding"><a href="#Redis-Cluster-data-sharding" class="headerlink" title="Redis Cluster data sharding"></a>Redis Cluster data sharding</h2><p>Redis Cluster does not use consistent hashing, but a different form of sharding where every key is conceptually part of what we call an <strong>hash slot</strong>.</p>
<p>There are 16384 hash slots in Redis Cluster, and to compute what is the hash slot of a given key, we simply take the CRC16 of the key modulo 16384.</p>
<p>Every node in a Redis Cluster is responsible for a subset of the hash slots, so for example you may have a cluster with 3 nodes, where:</p>
<ul>
<li>Node A contains hash slots from 0 to 5500.</li>
<li>Node B contains hash slots from 5501 to 11000.</li>
<li>Node C contains hash slots from 11001 to 16383.</li>
</ul>
<p>This allows to add and remove nodes in the cluster easily. For example if I want to add a new node D, I need to move some hash slot from nodes A, B, C to D. Similarly if I want to remove node A from the cluster I can just move the hash slots served by A to B and C. When the node A will be empty I can remove it from the cluster completely.</p>
<p>Because moving hash slots from a node to another does not require to stop operations, adding and removing nodes, or changing the percentage of hash slots hold by nodes, does not require any downtime.</p>
<p>Redis Cluster supports multiple key operations as long as all the keys involved into a single command execution (or whole transaction, or Lua script execution) all belong to the same hash slot. The user can force multiple keys to be part of the same hash slot by using a concept called <em>hash tags</em>.</p>
<p>Hash tags are documented in the Redis Cluster specification, but the gist is that if there is a substring between {} brackets in a key, only what is inside the string is hashed, so for example <code>this{foo}key</code> and <code>another{foo}key</code> are guaranteed to be in the same hash slot, and can be used together in a command with multiple keys as arguments.</p>
<p>See <a href="https://redis.io/topics/cluster-tutorial" target="_blank" rel="noopener">https://redis.io/topics/cluster-tutorial</a> for more details.</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å“¨å…µä¸ Redis Clusterï¼ˆRedis é›†ç¾¤è§£å†³æ–¹æ¡ˆï¼‰ æ²¡æœ‰å¤ªå¤šçš„è”ç³»ï¼š</p>
<ul>
<li>å“¨å…µä¸»è¦è§£å†³çš„æ˜¯high-availabilityé—®é¢˜ï¼Œå³å½“ä¸€ä¸ª master Redis nodeæŒ‚äº†ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª<strong>è‡ªåŠ¨åŒ–æœºåˆ¶</strong>ï¼Œä½¿å¾— slave nodeè‡ªåŠ¨å–ä»£ master Redis nodeï¼ˆå½“ç„¶æœ‰ä¸€ä¸ªå‰æï¼Œæ˜¯æˆ‘ä»¬é…ç½®äº†slave nodeï¼‰ï¼Œå¹¶æˆä¸ºä¸€ä¸ªæ–°çš„ master nodeã€‚</li>
<li>è€Œ Redis Cluster æ˜¯ä¸€ä¸ªRedis é›†ç¾¤è§£å†³æ–¹æ¡ˆï¼Œå®ƒä¸»è¦ä¸ºäº†è§£å†³æ°´å¹³æ‰©å®¹ï¼ˆhorizential scalingï¼‰é—®é¢˜ã€‚</li>
</ul>
<p>åœ¨ Redis Cluster ä¸­ï¼Œä¹Ÿä¸ºå®ç° high-availability æä¾›äº† solutionï¼Œå³ failure failoverï¼Œè¿™ä¸ªæœºåˆ¶ä¸å“¨å…µæœºåˆ¶ç¨æœ‰ä¸åŒï¼ˆå½“ç„¶ä»–ä»¬éƒ½æ˜¯ä¸ºäº†å®ç° high-availability ï¼‰ã€‚</p>
<p>æ¢è¨€ä¹‹ï¼Œå½“ä¸éœ€è¦æ•°æ®åˆ†ç‰‡ï¼ˆè™½ç„¶è¿™ä¸ªassumptionå¾€å¾€æ˜¯ä¸æ­£ç¡®çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ€ä¹ˆèƒ½ä¿è¯åœ¨æœ€å¼€å§‹å»ºç«‹ä¸€ä¸ªç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬å°±çŸ¥é“éœ€è¦å¤šå°‘æ•°æ®é‡ï¼Œä¸”åœ¨æ­¤ä¹‹åæˆ‘ä»¬çš„ç³»ç»Ÿæ°¸è¿œä¸ä¼šè¶…è¿‡è¿™ä¸ªæ•°æ®é‡ï¼‰ï¼Œæˆ–è€…å·±ç»åœ¨å®¢æˆ·ç«¯è¿›è¡Œ sharding çš„åœºæ™¯ä¸‹ï¼Œå“¨å…µå°±è¶³å¤Ÿä½¿ç”¨äº†ã€‚</p>
<p>ä½†å¦‚æœéœ€è¦è¿›è¡Œæ°´å¹³æ‰©å®¹ï¼ˆhorizential scalingï¼‰ï¼Œ åˆ™ Redis Cluster æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é€‰æ‹©ã€‚</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li><a href="https://redis.io/topics/replication" target="_blank" rel="noopener">https://redis.io/topics/replication</a></li>
<li><a href="https://redis.io/topics/cluster-tutorial" target="_blank" rel="noopener">https://redis.io/topics/cluster-tutorial</a></li>
<li><a href="https://redis.io/topics/sentinel" target="_blank" rel="noopener">https://redis.io/topics/sentinel</a></li>
<li><a href="https://www.infoq.cn/article/effective-ops-part-03/?utm_campaign=infoq_content&amp;utm_source=infoq&amp;utm_medium=feed&amp;utm_term=" target="_blank" rel="noopener">https://www.infoq.cn/article/effective-ops-part-03/?utm_campaign=infoq_content&amp;utm_source=infoq&amp;utm_medium=feed&amp;utm_term=</a></li>
</ul>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">Redis</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/Redis/" class="article-tag-list-link color1">Redis</a>
        		</li>
      		
		</ul>
	</div>


      

      
        
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <div class="wx-qrcode">
   
    </div>
</div>

<div class="mask js-mask"></div>
      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
    <a href="/2020/05/09/ã€Redisã€‘Redis-æ€§èƒ½æµ‹è¯•/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          ã€Redisã€‘Redis æ€§èƒ½æµ‹è¯•ï¼ˆredis-benchmarkï¼‰
        
      </div>
    </a>
  
  
    <a href="/2020/05/07/ã€Redisã€‘Redis-æŒä¹…åŒ–/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">ã€Redisã€‘Redis æŒä¹…åŒ–ï¼ˆPersistenceï¼‰</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>






  
    <div class="duoshuo"></div>
  




          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2020 è¥¿ç»´èœ€é»
    	</div>
      	<div class="footer-right">
      		
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: true,
		root: "/",
		innerArchive: true,
		showTags: true
	}
</script>

<script>!function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="./",n(0)}([function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){var e=/\/|index.html/g;return t.replace(e,"")===n.replace(e,"")}function i(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,e=0,r=t.length;e<r;e++){var i=t[e];o(n,i.getAttribute("href"))&&(0,d.default)(i,"active")}}function u(t){for(var n=t.offsetLeft,e=t.offsetParent;null!==e;)n+=e.offsetLeft,e=e.offsetParent;return n}function f(t){for(var n=t.offsetTop,e=t.offsetParent;null!==e;)n+=e.offsetTop,e=e.offsetParent;return n}function c(t,n,e,r,o){var i=u(t),c=f(t)-n;if(c-e<=o){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,h.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(e||c)+"px",a.style.left=i+"px",a.style.zIndex=r||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");c(t,document.body.scrollTop,-63,2,0),c(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}function l(){x.default.versions.mobile&&window.screen.width<800&&(i(),s())}var p=e(71),d=r(p),v=e(72),y=(r(v),e(84)),h=r(y),b=e(69),x=r(b),m=e(75),g=r(m),w=e(70);l(),(0,w.addLoadEvent)(function(){g.default.init()}),t.exports={}},function(t,n){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t,n){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},function(t,n,e){var r=e(49),o=e(15);t.exports=function(t){return r(o(t))}},function(t,n,e){t.exports=!e(8)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,e){var r=e(6),o=e(12);t.exports=e(4)?function(t,n,e){return r.f(t,n,o(1,e))}:function(t,n,e){return t[n]=e,t}},function(t,n,e){var r=e(10),o=e(30),i=e(24),u=Object.defineProperty;n.f=e(4)?Object.defineProperty:function(t,n,e){if(r(t),n=i(n,!0),r(e),o)try{return u(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},function(t,n,e){var r=e(22)("wks"),o=e(13),i=e(1).Symbol,u="function"==typeof i,f=t.exports=function(t){return r[t]||(r[t]=u&&i[t]||(u?i:o)("Symbol."+t))};f.store=r},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,e){var r=e(35),o=e(16);t.exports=Object.keys||function(t){return r(t,o)}},function(t,n,e){var r=e(11);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var e=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+r).toString(36))}},function(t,n){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,e){var r=e(6).f,o=e(2),i=e(7)("toStringTag");t.exports=function(t,n,e){t&&!o(t=e?t:t.prototype,i)&&r(t,i,{configurable:!0,value:n})}},function(t,n,e){var r=e(22)("keys"),o=e(13);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,n,e){var r=e(1),o="__core-js_shared__",i=r[o]||(r[o]={});t.exports=function(t){return i[t]||(i[t]={})}},function(t,n){var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},function(t,n,e){var r=e(11);t.exports=function(t,n){if(!r(t))return t;var e,o;if(n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;if("function"==typeof(e=t.valueOf)&&!r(o=e.call(t)))return o;if(!n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,n,e){var r=e(1),o=e(14),i=e(18),u=e(26),f=e(6).f;t.exports=function(t){var n=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==t.charAt(0)||t in n||f(n,t,{value:u.f(t)})}},function(t,n,e){n.f=e(7)},function(t,n,e){var r=e(1),o=e(14),i=e(46),u=e(5),f="prototype",c=function(t,n,e){var a,s,l,p=t&c.F,d=t&c.G,v=t&c.S,y=t&c.P,h=t&c.B,b=t&c.W,x=d?o:o[n]||(o[n]={}),m=x[f],g=d?r:v?r[n]:(r[n]||{})[f];d&&(e=n);for(a in e)s=!p&&g&&void 0!==g[a],s&&a in x||(l=s?g[a]:e[a],x[a]=d&&"function"!=typeof g[a]?e[a]:h&&s?i(l,r):b&&g[a]==l?function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n[f]=t[f],n}(l):y&&"function"==typeof l?i(Function.call,l):l,y&&((x.virtual||(x.virtual={}))[a]=l,t&c.R&&m&&!m[a]&&u(m,a,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,n){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t,n,e){var r=e(11),o=e(1).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,n,e){t.exports=!e(4)&&!e(8)(function(){return 7!=Object.defineProperty(e(29)("div"),"a",{get:function(){return 7}}).a})},function(t,n,e){"use strict";var r=e(18),o=e(27),i=e(36),u=e(5),f=e(2),c=e(17),a=e(51),s=e(20),l=e(58),p=e(7)("iterator"),d=!([].keys&&"next"in[].keys()),v="@@iterator",y="keys",h="values",b=function(){return this};t.exports=function(t,n,e,x,m,g,w){a(e,n,x);var O,S,_,j=function(t){if(!d&&t in A)return A[t];switch(t){case y:return function(){return new e(this,t)};case h:return function(){return new e(this,t)}}return function(){return new e(this,t)}},P=n+" Iterator",E=m==h,M=!1,A=t.prototype,T=A[p]||A[v]||m&&A[m],L=T||j(m),N=m?E?j("entries"):L:void 0,C="Array"==n?A.entries||T:T;if(C&&(_=l(C.call(new t)),_!==Object.prototype&&(s(_,P,!0),r||f(_,p)||u(_,p,b))),E&&T&&T.name!==h&&(M=!0,L=function(){return T.call(this)}),r&&!w||!d&&!M&&A[p]||u(A,p,L),c[n]=L,c[P]=b,m)if(O={values:E?L:j(h),keys:g?L:j(y),entries:N},w)for(S in O)S in A||i(A,S,O[S]);else o(o.P+o.F*(d||M),n,O);return O}},function(t,n,e){var r=e(10),o=e(55),i=e(16),u=e(21)("IE_PROTO"),f=function(){},c="prototype",a=function(){var t,n=e(29)("iframe"),r=i.length,o="<",u=">";for(n.style.display="none",e(48).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write(o+"script"+u+"document.F=Object"+o+"/script"+u),t.close(),a=t.F;r--;)delete a[c][i[r]];return a()};t.exports=Object.create||function(t,n){var e;return null!==t?(f[c]=r(t),e=new f,f[c]=null,e[u]=t):e=a(),void 0===n?e:o(e,n)}},function(t,n,e){var r=e(35),o=e(16).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,e){var r=e(2),o=e(3),i=e(45)(!1),u=e(21)("IE_PROTO");t.exports=function(t,n){var e,f=o(t),c=0,a=[];for(e in f)e!=u&&r(f,e)&&a.push(e);for(;n.length>c;)r(f,e=n[c++])&&(~i(a,e)||a.push(e));return a}},function(t,n,e){t.exports=e(5)},function(t,n,e){var r=e(15);t.exports=function(t){return Object(r(t))}},function(t,n,e){t.exports={default:e(41),__esModule:!0}},function(t,n,e){t.exports={default:e(42),__esModule:!0}},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var o=e(39),i=r(o),u=e(38),f=r(u),c="function"==typeof f.default&&"symbol"==typeof i.default?function(t){return typeof t}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":typeof t};n.default="function"==typeof f.default&&"symbol"===c(i.default)?function(t){return"undefined"==typeof t?"undefined":c(t)}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":"undefined"==typeof t?"undefined":c(t)}},function(t,n,e){e(65),e(63),e(66),e(67),t.exports=e(14).Symbol},function(t,n,e){e(64),e(68),t.exports=e(26).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,e){var r=e(3),o=e(61),i=e(60);t.exports=function(t){return function(n,e,u){var f,c=r(n),a=o(c.length),s=i(u,a);if(t&&e!=e){for(;a>s;)if(f=c[s++],f!=f)return!0}else for(;a>s;s++)if((t||s in c)&&c[s]===e)return t||s||0;return!t&&-1}}},function(t,n,e){var r=e(43);t.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)}}return function(){return t.apply(n,arguments)}}},function(t,n,e){var r=e(9),o=e(34),i=e(19);t.exports=function(t){var n=r(t),e=o.f;if(e)for(var u,f=e(t),c=i.f,a=0;f.length>a;)c.call(t,u=f[a++])&&n.push(u);return n}},function(t,n,e){t.exports=e(1).document&&document.documentElement},function(t,n,e){var r=e(28);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,n,e){var r=e(28);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,n,e){"use strict";var r=e(32),o=e(12),i=e(20),u={};e(5)(u,e(7)("iterator"),function(){return this}),t.exports=function(t,n,e){t.prototype=r(u,{next:o(1,e)}),i(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,e){var r=e(9),o=e(3);t.exports=function(t,n){for(var e,i=o(t),u=r(i),f=u.length,c=0;f>c;)if(i[e=u[c++]]===n)return e}},function(t,n,e){var r=e(13)("meta"),o=e(11),i=e(2),u=e(6).f,f=0,c=Object.isExtensible||function(){return!0},a=!e(8)(function(){return c(Object.preventExtensions({}))}),s=function(t){u(t,r,{value:{i:"O"+ ++f,w:{}}})},l=function(t,n){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,r)){if(!c(t))return"F";if(!n)return"E";s(t)}return t[r].i},p=function(t,n){if(!i(t,r)){if(!c(t))return!0;if(!n)return!1;s(t)}return t[r].w},d=function(t){return a&&v.NEED&&c(t)&&!i(t,r)&&s(t),t},v=t.exports={KEY:r,NEED:!1,fastKey:l,getWeak:p,onFreeze:d}},function(t,n,e){var r=e(6),o=e(10),i=e(9);t.exports=e(4)?Object.defineProperties:function(t,n){o(t);for(var e,u=i(n),f=u.length,c=0;f>c;)r.f(t,e=u[c++],n[e]);return t}},function(t,n,e){var r=e(19),o=e(12),i=e(3),u=e(24),f=e(2),c=e(30),a=Object.getOwnPropertyDescriptor;n.f=e(4)?a:function(t,n){if(t=i(t),n=u(n,!0),c)try{return a(t,n)}catch(t){}if(f(t,n))return o(!r.f.call(t,n),t[n])}},function(t,n,e){var r=e(3),o=e(33).f,i={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(t){try{return o(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==i.call(t)?f(t):o(r(t))}},function(t,n,e){var r=e(2),o=e(37),i=e(21)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,e){var r=e(23),o=e(15);t.exports=function(t){return function(n,e){var i,u,f=String(o(n)),c=r(e),a=f.length;return c<0||c>=a?t?"":void 0:(i=f.charCodeAt(c),i<55296||i>56319||c+1===a||(u=f.charCodeAt(c+1))<56320||u>57343?t?f.charAt(c):i:t?f.slice(c,c+2):(i-55296<<10)+(u-56320)+65536)}}},function(t,n,e){var r=e(23),o=Math.max,i=Math.min;t.exports=function(t,n){return t=r(t),t<0?o(t+n,0):i(t,n)}},function(t,n,e){var r=e(23),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,n,e){"use strict";var r=e(44),o=e(52),i=e(17),u=e(3);t.exports=e(31)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,e=this._i++;return!t||e>=t.length?(this._t=void 0,o(1)):"keys"==n?o(0,e):"values"==n?o(0,t[e]):o(0,[e,t[e]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(t,n){},function(t,n,e){"use strict";var r=e(59)(!0);e(31)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,e=this._i;return e>=n.length?{value:void 0,done:!0}:(t=r(n,e),this._i+=t.length,{value:t,done:!1})})},function(t,n,e){"use strict";var r=e(1),o=e(2),i=e(4),u=e(27),f=e(36),c=e(54).KEY,a=e(8),s=e(22),l=e(20),p=e(13),d=e(7),v=e(26),y=e(25),h=e(53),b=e(47),x=e(50),m=e(10),g=e(3),w=e(24),O=e(12),S=e(32),_=e(57),j=e(56),P=e(6),E=e(9),M=j.f,A=P.f,T=_.f,L=r.Symbol,N=r.JSON,C=N&&N.stringify,k="prototype",F=d("_hidden"),q=d("toPrimitive"),I={}.propertyIsEnumerable,B=s("symbol-registry"),D=s("symbols"),W=s("op-symbols"),H=Object[k],K="function"==typeof L,R=r.QObject,J=!R||!R[k]||!R[k].findChild,U=i&&a(function(){return 7!=S(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a})?function(t,n,e){var r=M(H,n);r&&delete H[n],A(t,n,e),r&&t!==H&&A(H,n,r)}:A,G=function(t){var n=D[t]=S(L[k]);return n._k=t,n},$=K&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},z=function(t,n,e){return t===H&&z(W,n,e),m(t),n=w(n,!0),m(e),o(D,n)?(e.enumerable?(o(t,F)&&t[F][n]&&(t[F][n]=!1),e=S(e,{enumerable:O(0,!1)})):(o(t,F)||A(t,F,O(1,{})),t[F][n]=!0),U(t,n,e)):A(t,n,e)},Y=function(t,n){m(t);for(var e,r=b(n=g(n)),o=0,i=r.length;i>o;)z(t,e=r[o++],n[e]);return t},Q=function(t,n){return void 0===n?S(t):Y(S(t),n)},X=function(t){var n=I.call(this,t=w(t,!0));return!(this===H&&o(D,t)&&!o(W,t))&&(!(n||!o(this,t)||!o(D,t)||o(this,F)&&this[F][t])||n)},V=function(t,n){if(t=g(t),n=w(n,!0),t!==H||!o(D,n)||o(W,n)){var e=M(t,n);return!e||!o(D,n)||o(t,F)&&t[F][n]||(e.enumerable=!0),e}},Z=function(t){for(var n,e=T(g(t)),r=[],i=0;e.length>i;)o(D,n=e[i++])||n==F||n==c||r.push(n);return r},tt=function(t){for(var n,e=t===H,r=T(e?W:g(t)),i=[],u=0;r.length>u;)!o(D,n=r[u++])||e&&!o(H,n)||i.push(D[n]);return i};K||(L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),n=function(e){this===H&&n.call(W,e),o(this,F)&&o(this[F],t)&&(this[F][t]=!1),U(this,t,O(1,e))};return i&&J&&U(H,t,{configurable:!0,set:n}),G(t)},f(L[k],"toString",function(){return this._k}),j.f=V,P.f=z,e(33).f=_.f=Z,e(19).f=X,e(34).f=tt,i&&!e(18)&&f(H,"propertyIsEnumerable",X,!0),v.f=function(t){return G(d(t))}),u(u.G+u.W+u.F*!K,{Symbol:L});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;nt.length>et;)d(nt[et++]);for(var nt=E(d.store),et=0;nt.length>et;)y(nt[et++]);u(u.S+u.F*!K,"Symbol",{for:function(t){return o(B,t+="")?B[t]:B[t]=L(t)},keyFor:function(t){if($(t))return h(B,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){J=!0},useSimple:function(){J=!1}}),u(u.S+u.F*!K,"Object",{create:Q,defineProperty:z,defineProperties:Y,getOwnPropertyDescriptor:V,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),N&&u(u.S+u.F*(!K||a(function(){var t=L();return"[null]"!=C([t])||"{}"!=C({a:t})||"{}"!=C(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!$(t)){for(var n,e,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);return n=r[1],"function"==typeof n&&(e=n),!e&&x(n)||(n=function(t,n){if(e&&(n=e.call(this,t,n)),!$(n))return n}),r[1]=n,C.apply(N,r)}}}),L[k][q]||e(5)(L[k],q,L[k].valueOf),l(L,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},function(t,n,e){e(25)("asyncIterator")},function(t,n,e){e(25)("observable")},function(t,n,e){e(62);for(var r=e(1),o=e(5),i=e(17),u=e(7)("toStringTag"),f=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],c=0;c<5;c++){var a=f[c],s=r[a],l=s&&s.prototype;l&&!l[u]&&o(l,u,a),i[a]=i.Array}},function(t,n){"use strict";var e={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&t.indexOf("KHTML")==-1,mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:t.indexOf("Safari")==-1,weixin:t.indexOf("MicroMessenger")==-1}}()};t.exports=e},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=e(40),i=r(o),u=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):o[t]||t}function n(t){return l[t]}var e=/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,r=/['<> "&]/g,o={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},f=/\u00a0/g,c=/<br\s*\/?>/gi,a=/\r?\n/g,s=/\s/g,l={};for(var p in o)l[o[p]]=p;return o["&apos;"]="'",l["'"]="&#39;",{encode:function(t){return t?(""+t).replace(r,n).replace(a,"<br/>").replace(s,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(c,"\n").replace(e,t).replace(f," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e+=2)n.push(String.fromCharCode("0x"+t.slice(e,e+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,e=t.length;e>n;n++)t[n]=u.encodeObject(t[n]);else if("object"==("undefined"==typeof t?"undefined":(0,i.default)(t)))for(var r in t)t[r]=u.encodeObject(t[r]);else if("string"==typeof t)return u.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=u},function(t,n){function e(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=e},function(t,n){function e(t,n){if(t.classList)t.classList.remove(n);else{var e=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(e," ")}}t.exports=e},,,function(t,n){"use strict";function e(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){var n=document.querySelectorAll(".article-entry a:not(.article-more-a)");n.forEach(function(t){t.setAttribute("target","_blank")})}var e=document.querySelector("#js-aboutme");e&&0!==e.length&&(e.innerHTML=e.innerText)}t.exports={init:e}},,,,,,,,,function(t,n){function e(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var e=t.nextSibling;return e?t.parentNode.insertBefore(n,e):t.parentNode.appendChild(n)}t.exports=e}])</script><script src="/./main.2d7529.js"></script><script>!function(){var e=function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)};e("/slider.885efe.js")}()</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 50%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">Tag</a></li>
      
        
      
      <li style="width: 50%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">Friends</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find somethingâ€¦">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Algorithm Problem</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">AWS</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Algorithm</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Architectural Pattern</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Architecture</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">ArchitectureDesign</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Nginx</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Frontend</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Cache</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Browser</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">C#</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Debug</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Visual Studio</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Cache System</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Compile</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Data Structure</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">JavaScript</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Data Format</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Database</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Design Pattern</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Distributed System</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Microservices</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Django</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Redis</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Docker</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">ELK</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Format</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Git</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Version Control</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Golang</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">HTTP</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Network</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Hardware</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Interview</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">JQuery</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Java EE</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Software Testing</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Java</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Network Programming</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">LaTeX</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Linux</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Operating System</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Linxu</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Lock</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">macOS</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Markdown</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Lucene</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Mattermost</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">MySQL</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Netwok</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Netwrok</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Node.js</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">nvm</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">NPM</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">npm</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">OOP</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">OpenWrt</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Operating Systems</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Performancede</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Performance</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Programming</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Protobuf</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Python</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">RaspbeeryPi</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Codis</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">SQL</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Regular Expression</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Security</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Spring</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">TypeScript</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">VMware</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Vmware</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Windows</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">WordPress</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">VPN</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">hexo</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">ZooKeeper</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">iOS</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">hugo</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            ç¼ºå¤±æ¨¡å—ã€‚<br/>1ã€åœ¨åšå®¢æ ¹ç›®å½•ï¼ˆæ³¨æ„ä¸æ˜¯yiliaæ ¹ç›®å½•ï¼‰æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<br/> npm i hexo-generator-json-content --save<br/><br/>
            2ã€åœ¨æ ¹ç›®å½•_config.ymlé‡Œæ·»åŠ é…ç½®ï¼š
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: true
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://swsmile.info/en/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>My English Blog</a>
            </li>
          
            <li class="search-li">
              <a href="http://swsmile.info/oj/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>My OJ Blog</a>
            </li>
          
            <li class="search-li">
              <a href="http://swsmile.info/gym/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>è¥¿ç»´èœ€é»çš„å¥èº« Blog</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->



</body>
</html>