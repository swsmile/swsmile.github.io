<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="dns-prefetch" href="http://swsmile.info">
  <title>ã€å¹¶å‘æ§åˆ¶ã€‘ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic Concurrency Controlï¼‰ä¸æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic Concurrency Controlï¼‰ | è¥¿ç»´èœ€é» çš„åšå®¢</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Update 2020.6.1 updateï¼šä»Šå¤©å’Œå®¤å‹è®¨è®ºï¼Œå‘ç°å¤§å®¶éƒ½çœ‹çš„æ˜¯ â€œä¹è§‚é”ã€æ‚²è§‚é”ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼â€ ï¼ˆhttps://segmentfault.com/a/1190000016611415ï¼‰æ¥å­¦ä¹ ä¹è§‚å¹¶å‘æ§åˆ¶å’Œæ‚²è§‚å¹¶å‘æ§åˆ¶ã€‚ ç„¶è€Œï¼Œè¿™ç¯‡æ–‡ç« ä¸­æåˆ°äº†â€œä¹è§‚é”â€çš„æ¦‚å¿µï¼Œè€Œè¿™ä¸ªè¯æœ¬èº«å°±æ˜¯è‡ªç›¸çŸ›ç›¾çš„ï¼Œi.e., é”ï¼ˆlockï¼‰ï¼Œæˆ–è€…ç§°ä¸ºäº’æ–¥é”ï¼ˆmutexï¼‰æœ¬èº«å°±æ˜¯åŸºäºæ‚²è§‚å¹¶å‘æ§åˆ¶æ€æƒ³ï¼Œæ‰€ä»¥">
<meta name="keywords" content="Operating System">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€å¹¶å‘æ§åˆ¶ã€‘ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic Concurrency Controlï¼‰ä¸æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic Concurrency Controlï¼‰">
<meta property="og:url" content="http://swsmile.info/2019/02/17/ã€Operating-Systemã€‘å¹¶å‘æ§åˆ¶ï¼ˆConcurrency Controlï¼‰/index.html">
<meta property="og:site_name" content="è¥¿ç»´èœ€é» çš„åšå®¢">
<meta property="og:description" content="Update 2020.6.1 updateï¼šä»Šå¤©å’Œå®¤å‹è®¨è®ºï¼Œå‘ç°å¤§å®¶éƒ½çœ‹çš„æ˜¯ â€œä¹è§‚é”ã€æ‚²è§‚é”ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼â€ ï¼ˆhttps://segmentfault.com/a/1190000016611415ï¼‰æ¥å­¦ä¹ ä¹è§‚å¹¶å‘æ§åˆ¶å’Œæ‚²è§‚å¹¶å‘æ§åˆ¶ã€‚ ç„¶è€Œï¼Œè¿™ç¯‡æ–‡ç« ä¸­æåˆ°äº†â€œä¹è§‚é”â€çš„æ¦‚å¿µï¼Œè€Œè¿™ä¸ªè¯æœ¬èº«å°±æ˜¯è‡ªç›¸çŸ›ç›¾çš„ï¼Œi.e., é”ï¼ˆlockï¼‰ï¼Œæˆ–è€…ç§°ä¸ºäº’æ–¥é”ï¼ˆmutexï¼‰æœ¬èº«å°±æ˜¯åŸºäºæ‚²è§‚å¹¶å‘æ§åˆ¶æ€æƒ³ï¼Œæ‰€ä»¥">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2020-07-04T04:32:24.388Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ã€å¹¶å‘æ§åˆ¶ã€‘ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic Concurrency Controlï¼‰ä¸æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic Concurrency Controlï¼‰">
<meta name="twitter:description" content="Update 2020.6.1 updateï¼šä»Šå¤©å’Œå®¤å‹è®¨è®ºï¼Œå‘ç°å¤§å®¶éƒ½çœ‹çš„æ˜¯ â€œä¹è§‚é”ã€æ‚²è§‚é”ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼â€ ï¼ˆhttps://segmentfault.com/a/1190000016611415ï¼‰æ¥å­¦ä¹ ä¹è§‚å¹¶å‘æ§åˆ¶å’Œæ‚²è§‚å¹¶å‘æ§åˆ¶ã€‚ ç„¶è€Œï¼Œè¿™ç¯‡æ–‡ç« ä¸­æåˆ°äº†â€œä¹è§‚é”â€çš„æ¦‚å¿µï¼Œè€Œè¿™ä¸ªè¯æœ¬èº«å°±æ˜¯è‡ªç›¸çŸ›ç›¾çš„ï¼Œi.e., é”ï¼ˆlockï¼‰ï¼Œæˆ–è€…ç§°ä¸ºäº’æ–¥é”ï¼ˆmutexï¼‰æœ¬èº«å°±æ˜¯åŸºäºæ‚²è§‚å¹¶å‘æ§åˆ¶æ€æƒ³ï¼Œæ‰€ä»¥">
  
    <link rel="alternative" href="/atom.xml" title="è¥¿ç»´èœ€é» çš„åšå®¢" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.2d7529.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    // listen to any DOM change and automatically perform spacing via MutationObserver()
    pangu.autoSpacingPage();
  });
</script>
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-78769787-2', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
<script>
var _hmt = _hmt || [];
(function() {
	var hm = document.createElement("script");
	hm.src = "https://hm.baidu.com/hm.js?4481376a6b117446f0ad6f2b9b796afc";
	var s = document.getElementsByTagName("script")[0]; 
	s.parentNode.insertBefore(hm, s);
})();
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->



</head>
</html>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/logo.jpg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">è¥¿ç»´èœ€é»</a></h1>
		</hgroup>
		
		<p class="header-subtitle">ğŸ’ Software engineer | ğŸ“·Photographer | ğŸ‘¹Urban explorer</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">ä¸»é¡µ</a></li>
	        
				<li><a href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">Tag</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">Friends</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="mail" target="_blank" href="mailto:swsmile1028@gmail.com" title="mail"><i class="icon-mail"></i></a>
		        
					<a class="github" target="_blank" href="https://github.com/swsmile" title="github"><i class="icon-github"></i></a>
		        
					<a class="linkedin" target="_blank" href="https://www.linkedin.com/in/weishi1028/" title="linkedin"><i class="icon-linkedin"></i></a>
		        
					<a class="weibo" target="_blank" href="https://weibo.com/swsmile666" title="weibo"><i class="icon-weibo"></i></a>
		        
					<a class="facebook" target="_blank" href="https://www.facebook.com/swsmile666" title="facebook"><i class="icon-facebook"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/logo.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">è¥¿ç»´èœ€é»</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>ğŸ’ Software engineer | ğŸ“·Photographer | ğŸ‘¹Urban explorer<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="mail" target="_blank" href="mailto:swsmile1028@gmail.com" title="mail"><i class="icon-mail"></i></a>
			        
						<a class="github" target="_blank" href="https://github.com/swsmile" title="github"><i class="icon-github"></i></a>
			        
						<a class="linkedin" target="_blank" href="https://www.linkedin.com/in/weishi1028/" title="linkedin"><i class="icon-linkedin"></i></a>
			        
						<a class="weibo" target="_blank" href="https://weibo.com/swsmile666" title="weibo"><i class="icon-weibo"></i></a>
			        
						<a class="facebook" target="_blank" href="https://www.facebook.com/swsmile666" title="facebook"><i class="icon-facebook"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 50%">
				
				
					<li style="width: 50%"><a href="/">ä¸»é¡µ</a></li>
		        
					<li style="width: 50%"><a href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            <article id="post-ã€Operating-Systemã€‘å¹¶å‘æ§åˆ¶ï¼ˆConcurrency Controlï¼‰" class="article article-type-post " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ã€å¹¶å‘æ§åˆ¶ã€‘ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic Concurrency Controlï¼‰ä¸æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic Concurrency Controlï¼‰
    </h1>
  

        
        <a href="/2019/02/17/ã€Operating-Systemã€‘å¹¶å‘æ§åˆ¶ï¼ˆConcurrency Controlï¼‰/" class="archive-article-date">
  	<time datetime="2019-02-17T06:40:02.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2019-02-17</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h1><blockquote>
<p>2020.6.1 updateï¼šä»Šå¤©å’Œå®¤å‹è®¨è®ºï¼Œå‘ç°å¤§å®¶éƒ½çœ‹çš„æ˜¯ â€œä¹è§‚é”ã€æ‚²è§‚é”ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼â€ ï¼ˆ<a href="https://segmentfault.com/a/1190000016611415ï¼‰æ¥å­¦ä¹ ä¹è§‚å¹¶å‘æ§åˆ¶å’Œæ‚²è§‚å¹¶å‘æ§åˆ¶ã€‚" target="_blank" rel="noopener">https://segmentfault.com/a/1190000016611415ï¼‰æ¥å­¦ä¹ ä¹è§‚å¹¶å‘æ§åˆ¶å’Œæ‚²è§‚å¹¶å‘æ§åˆ¶ã€‚</a></p>
<p>ç„¶è€Œï¼Œè¿™ç¯‡æ–‡ç« ä¸­æåˆ°äº†â€œä¹è§‚é”â€çš„æ¦‚å¿µï¼Œè€Œè¿™ä¸ªè¯æœ¬èº«å°±æ˜¯è‡ªç›¸çŸ›ç›¾çš„ï¼Œi.e., é”ï¼ˆlockï¼‰ï¼Œæˆ–è€…ç§°ä¸ºäº’æ–¥é”ï¼ˆmutexï¼‰æœ¬èº«å°±æ˜¯åŸºäºæ‚²è§‚å¹¶å‘æ§åˆ¶æ€æƒ³ï¼Œæ‰€ä»¥æ ¹æœ¬ä¸å­˜åœ¨â€œä¹è§‚é”â€è¿™ç§é”ã€‚å–è€Œä»£ä¹‹ï¼Œå°†å…¶ç§°ä¸ºâ€œä¹è§‚å¹¶å‘æ§åˆ¶æ€æƒ³â€åˆ™ç›¸å¯¹æ›´åˆé€‚ã€‚</p>
<p>å…¶å®ï¼Œæœç´¢ä¸€ä¸‹â€optimistic lockingâ€ï¼Œå‘ç°ä»ç„¶è¿˜æ˜¯æœ‰å¾ˆå¤šçš„ç»“æœï¼Œè¿™è¯´æ˜è¿™å…¶å®ä¸æ˜¯å› ä¸ºç¿»è¯‘çš„åŸå› ã€‚</p>
<p>ä»Šå¤©çªç„¶æ„è¯†åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œäºæ˜¯é‡æ–°æ›´æ–°äº†è¿™ç¯‡ blogã€‚</p>
</blockquote>
<h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><h2 id="å¹¶å‘æ§åˆ¶ï¼ˆConcurrency-Controlï¼‰"><a href="#å¹¶å‘æ§åˆ¶ï¼ˆConcurrency-Controlï¼‰" class="headerlink" title="å¹¶å‘æ§åˆ¶ï¼ˆConcurrency Controlï¼‰"></a>å¹¶å‘æ§åˆ¶ï¼ˆConcurrency Controlï¼‰</h2><p>éœ€è¦å¹¶å‘æ§åˆ¶ï¼ˆConcurrency Controlï¼‰ï¼Œå…¶å®æ˜¯ä¸ºäº†å®ç°æŸäº›ä¸€è‡´æ€§è§„åˆ™ï¼ˆconsistency rulesï¼‰ã€‚</p>
<p>éœ€è¦å¹¶å‘æ§åˆ¶çš„ä¸€äº›åœºæ™¯ï¼š</p>
<ul>
<li>å®ç°æ•°æ®åº“çš„ ACID ä¸­çš„ä¸€è‡´æ€§ï¼ˆconsistencyï¼‰</li>
<li>ç¼–ç¨‹ä¸­çš„å®ç°äº’æ–¥ï¼ˆmutual exclusionï¼‰ï¼Œæ¯”å¦‚Javaä¸­çš„ <code>synchrinzed</code> æ–¹æ³• </li>
</ul>
<p>å¯¹åº”åœ°ï¼Œå¦‚æœéœ€è¦å¹¶å‘æ§åˆ¶æœºåˆ¶ï¼Œä½†åˆæ²¡æœ‰åº”ç”¨ä»»ä½•å¹¶å‘æ§åˆ¶æœºåˆ¶ï¼Œè‡ªç„¶ä¼šäº§ç”ŸæŸäº›é—®é¢˜ï¼Œå…¸å‹çš„åŒ…æ‹¬ï¼š</p>
<ul>
<li>Read-copy-update</li>
<li>The lost update problem: A second transaction writes a second value of a data-item (datum) on top of a first value written by a first concurrent transaction, and the first value is lost to other transactions running concurrently which need, by their precedence, to read the first value. The transactions that have read the wrong value end with incorrect results.</li>
<li>The dirty read problem: Transactions read a value written by a transaction that has been later aborted. This value disappears from the database upon abort, and should not have been read by any transaction (â€œdirty readâ€). The reading transactions end with incorrect results.</li>
<li>The incorrect summary problem: While one transaction takes a summary over the values of all the instances of a repeated data-item, a second transaction updates some instances of that data-item. The resulting summary does not reflect a correct result for any (usually needed for correctness) precedence order between the two transactions (if one is executed before the other), but rather some random result, depending on the timing of the updates, and whether certain update results have been included in the summary or not.</li>
</ul>
<h2 id="æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic-Concurrency-Controlï¼‰ä¸ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic-Concurrency-Controlï¼‰"><a href="#æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic-Concurrency-Controlï¼‰ä¸ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic-Concurrency-Controlï¼‰" class="headerlink" title="æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic Concurrency Controlï¼‰ä¸ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic Concurrency Controlï¼‰"></a>æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic Concurrency Controlï¼‰ä¸ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic Concurrency Controlï¼‰</h2><p>ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic Concurrency Controlï¼‰å¯¹åº”äºç”Ÿæ´»ä¸­ä¹è§‚çš„äººæ€»æ˜¯æƒ³ç€äº‹æƒ…å¾€å¥½çš„æ–¹å‘å‘å±•ï¼Œæ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic Concurrency Controlï¼‰å¯¹åº”äºç”Ÿæ´»ä¸­æ‚²è§‚çš„äººæ€»æ˜¯æƒ³ç€äº‹æƒ…å¾€åçš„æ–¹å‘å‘å±•ã€‚è¿™ä¸¤ç§äººå„æœ‰ä¼˜ç¼ºç‚¹ï¼Œä¸èƒ½ä¸ä»¥åœºæ™¯è€Œå®šè¯´ä¸€ç§äººå¥½äºå¦å¤–ä¸€ç§äººã€‚</p>
<a id="more"></a> 



<h2 id="æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic-Concurrency-Controlï¼‰"><a href="#æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic-Concurrency-Controlï¼‰" class="headerlink" title="æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic Concurrency Controlï¼‰"></a>æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic Concurrency Controlï¼‰</h2><p>æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic Concurrency Controlï¼‰æ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œå³æ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨ä¿®æ”¹æ•°æ®çš„æ—¶å€™éƒ½ä¼šå…ˆæŠŠæ•°æ®â€œé”èµ·æ¥â€ï¼Œæ¥é˜»æ­¢å…¶ä»–äººå¯¹æ•°æ®çš„ä¿®æ”¹ã€‚</p>
<p>å› æ­¤ï¼Œè‡ªç„¶åœ°ï¼Œå®ç°æ‚²è§‚å¹¶å‘æ§åˆ¶çš„æœ€å…¸å‹çš„æ–¹å¼å°±æ˜¯ä½¿ç”¨<strong>é”ï¼ˆlockï¼‰</strong>äº†ï¼Œ</p>
<ul>
<li>ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶ï¼Œæ¯”å¦‚è¡Œé”ï¼Œè¡¨é”ç­‰ï¼Œè¯»é”ï¼Œå†™é”ç­‰ï¼Œå³ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚</li>
<li>Java ä¸­åŸºäº<code>synchronized</code> å…³é”®å­—çš„<strong>ç‹¬å é”ï¼ˆexclusive lockï¼‰</strong>å°±æ˜¯åŸºäºæ‚²è§‚é”æ€æƒ³çš„å®ç°ã€‚</li>
</ul>
<p>å½“ä¸Šé”åï¼Œå³ä½¿åˆ«äººæƒ³æ‹¿æˆ–è€…ä¿®æ”¹è¿™ä¸ªæ•°æ®ï¼Œä¹Ÿæ— æ³•åšåˆ°ã€‚å› æ­¤ï¼Œ</p>
<ul>
<li>ä»–å¯èƒ½ä¼šä¸æ–­çš„é‡è¯•ï¼ˆç›´åˆ°æ‹¿åˆ°è¿™ä¸ªé”ï¼‰ï¼Œè¿™ç§°ä¸º<strong>è‡ªæ—‹ï¼ˆspinï¼‰</strong>ï¼›</li>
<li>ä¹Ÿå¯èƒ½ç›´æ¥è¿›å…¥é˜»å¡çŠ¶æ€ï¼ˆç›®çš„æ˜¯ä¸ºäº†èŠ‚çœCPUæ—¶é—´ç‰‡ï¼‰ã€‚ç›´æ¥å½“é”è¢«é‡Šæ”¾æ—¶ï¼Œä¼šè¢«å”¤é†’ä¸”å°è¯•å†æ¬¡è·å–é”ã€‚</li>
</ul>
<p>æ‚²è§‚å¹¶å‘æ§åˆ¶é€šå¸¸æ¥è¯´ä¼šé€ æˆæ€§èƒ½çš„ä¸‹é™ã€‚è€Œä¸”ï¼Œæœ‰æ—¶è¿˜ä¼šå‡ºç°é”™è¯¯æƒ…å†µï¼Œæ¯”å¦‚æ­»é”ï¼ˆdeallockï¼‰</p>
<h2 id="ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic-Concurrency-Controlï¼‰"><a href="#ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic-Concurrency-Controlï¼‰" class="headerlink" title="ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic Concurrency Controlï¼‰"></a>ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic Concurrency Controlï¼‰</h2><p>ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic Concurrency Controlï¼‰åˆ™æ€»æ˜¯å‡è®¾æœ€å¥½çš„æƒ…å†µï¼Œå³è®¤ä¸ºæ¯æ¬¡å»ä¿®æ”¹æ•°æ®çš„æ—¶å€™ï¼Œåˆ«äººå‡ä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ï¼Œä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´ï¼Œåˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ã€‚</p>
<h3 id="ä»£è¡¨"><a href="#ä»£è¡¨" class="headerlink" title="ä»£è¡¨"></a>ä»£è¡¨</h3><p>ä¹è§‚å¹¶å‘æ§åˆ¶æ€æƒ³çš„ä»£è¡¨ï¼š</p>
<ul>
<li><strong>å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMultiversion concurrency control, MVCCï¼‰</strong></li>
<li><strong>éé˜»å¡ç®—æ³•ï¼ˆnon-blocking algorithmï¼‰</strong>ï¼Œéé˜»å¡ç®—æ³•éƒ½ä¾èµ–äºCPUæŒ‡ä»¤é›†æä¾›çš„åŸå­ä¿®æ”¹åŸè¯­æŒ‡ä»¤ï¼ˆatomic read-modify-write primitivesï¼‰ï¼Œæœ€å…¸å‹çš„éé˜»å¡ç®—æ³•å°±æ˜¯<strong>CAS ç®—æ³• ï¼ˆcompare-and-swapï¼‰</strong></li>
</ul>
<p>åœºæ™¯ï¼š</p>
<ul>
<li>åƒæ•°æ®åº“æä¾›çš„ç±»ä¼¼äº <strong>write_condition çš„æœºåˆ¶</strong>ï¼Œå…¶å®éƒ½æ˜¯åŸºäºä¹è§‚é”å¹¶å‘æ§åˆ¶æ€æƒ³çš„ä½“ç°ã€‚</li>
<li>åœ¨ Java ä¸­<code>java.util.concurrent.atomic</code> åŒ…ä¸­ï¼Œæä¾›äº†å¾ˆå¤šæ”¯æŒåŸå­æ“ä½œçš„ç±»ã€‚å¦‚ï¼šAtomicBooleanã€AtomicIntegerã€AtomicLongã€AtomicReference ç­‰ï¼Œå…¨éƒ½æ˜¯åŸºäºä¹è§‚å¹¶å‘æ§åˆ¶æ€æƒ³çš„ CAS ç®—æ³•å®ç°çš„ã€‚</li>
<li>åœ¨ SVN ã€Git ç­‰ç‰ˆæœ¬æ§åˆ¶ç®¡ç†å™¨ä¸­ï¼Œä¹Ÿæœ‰ä¹è§‚é”å¹¶å‘æ§åˆ¶æ€æƒ³çš„ä½“ç°ã€‚å½“ä½ æäº¤æ•°æ®çš„æ—¶å€™å¯¹æ¯”ä¸‹ç‰ˆæœ¬å·ï¼Œå¦‚æœè¿œç¨‹ä»“åº“çš„ç‰ˆæœ¬å·å’Œæœ¬åœ°çš„ä¸ä¸€æ ·ï¼Œå°±è¡¨ç¤ºæœ‰äººå·²ç»æäº¤è¿‡ä»£ç äº†ï¼Œä½ éœ€è¦å…ˆæ›´æ–°ä»£ç åˆ°æœ¬åœ°å¤„ç†ä¸€ä¸‹ç‰ˆæœ¬å†²çªé—®é¢˜ï¼Œä¸ç„¶æ˜¯æ²¡æœ‰åŠæ³•æäº¤çš„ã€‚</li>
<li>HTTP Headerä¸­çš„ <code>If-Match</code>ï¼ŒThe GET method returns an ETag for a resource and subsequent PUTs use the ETag value in the If-Match headers; while the first PUT will succeed, the second will not, as the value in If-Match is based on the first version of the resource</li>
</ul>
<p><strong>ä¹è§‚é”é€‚ç”¨äºå¤šè¯»å°‘å†™çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡</strong>ã€‚</p>
<h3 id="ä¹è§‚å¹¶å‘æ§åˆ¶çš„å‡ ä¸ªé˜¶æ®µ"><a href="#ä¹è§‚å¹¶å‘æ§åˆ¶çš„å‡ ä¸ªé˜¶æ®µ" class="headerlink" title="ä¹è§‚å¹¶å‘æ§åˆ¶çš„å‡ ä¸ªé˜¶æ®µ"></a>ä¹è§‚å¹¶å‘æ§åˆ¶çš„å‡ ä¸ªé˜¶æ®µ</h3><p>Optimistic concurrency control transactions involve these phases:</p>
<ul>
<li><strong>Begin</strong>: Record a timestamp marking the transactionâ€™s beginning.</li>
<li><strong>Modify</strong>: Read database values, and tentatively write changes.</li>
<li><strong>Validate</strong>: Check whether other transactions have modified data that this transaction has used (read or written). This includes transactions that completed after this transactionâ€™s start time, and optionally, transactions that are still active at validation time.</li>
<li><strong>Commit/Rollback</strong>: If there is no conflict, make all changes take effect. If there is a conflict, resolve it, typically by aborting the transaction, although other resolution schemes are possible. Care must be taken to avoid a <a href="https://en.wikipedia.org/wiki/TOCTTOU" target="_blank" rel="noopener">TOCTTOU</a> bug, particularly if this phase and the previous one are not performed as a single <a href="https://en.wikipedia.org/wiki/Linearizability" target="_blank" rel="noopener">atomic</a> operation.</li>
</ul>
<h1 id="ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic-Concurrency-Controlï¼‰æ€æƒ³çš„åˆ†æ"><a href="#ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic-Concurrency-Controlï¼‰æ€æƒ³çš„åˆ†æ" class="headerlink" title="ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic Concurrency Controlï¼‰æ€æƒ³çš„åˆ†æ"></a>ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic Concurrency Controlï¼‰æ€æƒ³çš„åˆ†æ</h1><p>ä»ä¸Šé¢å¯¹ä¸¤ç§å¹¶å‘æ§åˆ¶æ€æƒ³çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“ä¸¤ç§é”å„æœ‰ä¼˜ç¼ºç‚¹ï¼Œä¸å¯è®¤ä¸ºä¸€ç§å¥½äºå¦ä¸€ç§ã€‚</p>
<p><strong>ä¹è§‚å¹¶å‘æ§åˆ¶é€‚ç”¨äºå†™æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ˆå¤šè¯»åœºæ™¯ï¼‰</strong>ï¼Œå³å†²çªå¾ˆå°‘å‘ç”Ÿï¼Œè¿™æ ·å¯ä»¥çœå»äº†åŠ é”çš„å¼€é”€ï¼Œæé«˜äº†ç³»ç»Ÿçš„æ•´ä¸ªååé‡ã€‚ä½†å¦‚æœæ˜¯å¤šå†™çš„æƒ…å†µï¼Œä¸€èˆ¬ä¼šç»å¸¸äº§ç”Ÿå†²çªï¼Œè¿™å°±ä¼šå¯¼è‡´ä¸Šå±‚åº”ç”¨ä¼šä¸æ–­çš„è¿›è¡Œä¸æ–­åœ°å¤šæ¬¡å°è¯•ï¼ˆretryï¼‰ï¼Œè¿™æ ·åå€’æ˜¯é™ä½äº†æ€§èƒ½ï¼Œæ‰€ä»¥<strong>ä¸€èˆ¬å¤šå†™çš„åœºæ™¯ä¸‹ç”¨æ‚²è§‚å¹¶å‘æ§åˆ¶æœºåˆ¶å°±æ¯”è¾ƒåˆé€‚ã€‚</strong></p>
<h2 id="ä¹è§‚å¹¶å‘æ§åˆ¶æ€æƒ³å¸¸è§çš„ä¸¤ç§å®ç°æ–¹å¼"><a href="#ä¹è§‚å¹¶å‘æ§åˆ¶æ€æƒ³å¸¸è§çš„ä¸¤ç§å®ç°æ–¹å¼" class="headerlink" title="ä¹è§‚å¹¶å‘æ§åˆ¶æ€æƒ³å¸¸è§çš„ä¸¤ç§å®ç°æ–¹å¼"></a>ä¹è§‚å¹¶å‘æ§åˆ¶æ€æƒ³å¸¸è§çš„ä¸¤ç§å®ç°æ–¹å¼</h2><p>ä¹è§‚é”å¯ä»¥ä½¿ç”¨<strong>å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMultiversion concurrency control, MVCCï¼‰</strong>æˆ– <strong>CAS ç®—æ³•</strong>æ¥å®ç°ã€‚</p>
<h3 id="1-å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMultiversion-concurrency-control-MVCCï¼‰"><a href="#1-å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMultiversion-concurrency-control-MVCCï¼‰" class="headerlink" title="1 å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMultiversion concurrency control, MVCCï¼‰"></a>1 å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMultiversion concurrency control, MVCCï¼‰</h3><p>è¿™é‡Œçš„ç‰ˆæœ¬å·å¯ä»¥ä»»ä½•å±æ€§ï¼Œåªè¦å½“ä¸€æ¬¡æ•°æ®ä¿®æ”¹æ“ä½œè¢«æ‰§è¡Œåï¼Œè¿™ä¸ªå±æ€§ä¸€å®šä¼šè¢«æ”¹å˜å³å¯ï¼Œæ¯”å¦‚æ•°æ®è¢«ä¿®æ”¹çš„æ¬¡æ•°ã€ç‰ˆæœ¬å·ã€æ—¶é—´æˆ³ï¼ˆtimestampï¼‰ã€‚</p>
<p> ä¸€èˆ¬æ˜¯åœ¨æ•°æ®è¡¨ä¸­åŠ ä¸Šä¸€ä¸ªæ•°æ®ç‰ˆæœ¬å· version å­—æ®µï¼Œè¡¨ç¤ºæ•°æ®è¢«ä¿®æ”¹çš„æ¬¡æ•°ï¼Œå½“æ•°æ®è¢«ä¿®æ”¹æ—¶ï¼Œversion å€¼ä¼šåŠ ä¸€ã€‚å½“çº¿ç¨‹ A è¦æ›´æ–°æ•°æ®å€¼æ—¶ï¼Œåœ¨è¯»å–æ•°æ®çš„åŒæ—¶ï¼Œä¹Ÿä¼šè¯»å– version å€¼ï¼Œåœ¨æäº¤æ›´æ–°æ—¶ï¼Œè‹¥åˆšæ‰è¯»å–åˆ°çš„ version å€¼ä¸ºå½“å‰æ•°æ®åº“ä¸­çš„ version å€¼ç›¸ç­‰æ—¶æ‰æ›´æ–°ï¼Œå¦åˆ™é‡è¯•æ›´æ–°æ“ä½œï¼Œç›´åˆ°æ›´æ–°æˆåŠŸã€‚</p>
<ul>
<li>å–å‡ºè®°å½•æ—¶ï¼Œè·å–å½“å‰ <code>version</code>ï¼›</li>
<li>æ›´æ–°æ—¶ï¼Œå¸¦ä¸Šè¿™ä¸ª <code>version</code>ï¼›</li>
<li>æ‰§è¡Œæ›´æ–°ï¼Œå…ˆæ‰§è¡Œ <code>set version = newVersion where version = oldVersion</code>ï¼›</li>
<li>å¦‚æœä¸Šé¢æ‰§è¡Œçš„ <code>set</code>è¯­å¥æ²¡æœ‰å½±å“ä»»ä½•è¡Œï¼Œå°±æ›´æ–°å¤±è´¥ï¼›</li>
<li>å¹¶ä¸”ä¸æ–­é‡è¯•ã€‚</li>
</ul>
<p><strong>ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</strong> å‡è®¾æ•°æ®åº“ä¸­å¸æˆ·ä¿¡æ¯è¡¨ä¸­æœ‰ä¸€ä¸ª version å­—æ®µï¼Œå½“å‰å€¼ä¸º 1 ï¼›è€Œå½“å‰å¸æˆ·ä½™é¢å­—æ®µï¼ˆ balance ï¼‰ä¸º $100 ã€‚</p>
<ol>
<li>æ“ä½œå‘˜ A æ­¤æ—¶å°†å…¶è¯»å‡ºï¼ˆ version=1 ï¼‰ï¼Œå¹¶ä»å…¶å¸æˆ·ä½™é¢ä¸­æ‰£é™¤ $50ï¼ˆ $100-$50 ï¼‰ã€‚</li>
<li>åœ¨æ“ä½œå‘˜ A æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œæ“ä½œå‘˜B ä¹Ÿè¯»å…¥æ­¤ç”¨æˆ·ä¿¡æ¯ï¼ˆ version=1 ï¼‰ï¼Œå¹¶ä»å…¶å¸æˆ·ä½™é¢ä¸­æ‰£é™¤ $20 ï¼ˆ $100-$20 ï¼‰ã€‚</li>
<li>æ“ä½œå‘˜ A å®Œæˆäº†ä¿®æ”¹å·¥ä½œï¼Œå°†æ•°æ®ç‰ˆæœ¬å·åŠ ä¸€ï¼ˆ version=2 ï¼‰ï¼Œè¿åŒå¸æˆ·æ‰£é™¤åä½™é¢ï¼ˆ balance=$50 ï¼‰ï¼Œæäº¤è‡³æ•°æ®åº“æ›´æ–°ï¼Œæ­¤æ—¶ç”±äºæäº¤æ•°æ®ç‰ˆæœ¬å¤§äºæ•°æ®åº“è®°å½•å½“å‰ç‰ˆæœ¬ï¼Œæ•°æ®è¢«æ›´æ–°ï¼Œæ•°æ®åº“è®°å½• version æ›´æ–°ä¸º 2 ã€‚</li>
<li>æ“ä½œå‘˜ B å®Œæˆäº†æ“ä½œï¼Œä¹Ÿå°†ç‰ˆæœ¬å·åŠ ä¸€ï¼ˆ version=2 ï¼‰è¯•å›¾å‘æ•°æ®åº“æäº¤æ•°æ®ï¼ˆ balance=$80 ï¼‰ï¼Œä½†æ­¤æ—¶æ¯”å¯¹æ•°æ®åº“è®°å½•ç‰ˆæœ¬æ—¶å‘ç°ï¼Œæ“ä½œå‘˜ B æäº¤çš„æ•°æ®ç‰ˆæœ¬å·ä¸º 2 ï¼Œæ•°æ®åº“è®°å½•å½“å‰ç‰ˆæœ¬ä¹Ÿä¸º 2 ï¼Œä¸æ»¡è¶³ â€œ æäº¤ç‰ˆæœ¬å¿…é¡»å¤§äºè®°å½•å½“å‰ç‰ˆæœ¬æ‰èƒ½æ‰§è¡Œæ›´æ–° â€œ çš„ä¹è§‚é”ç­–ç•¥ï¼Œå› æ­¤ï¼Œæ“ä½œå‘˜ B çš„æäº¤è¢«é©³å›ã€‚</li>
</ol>
<p>è¿™æ ·ï¼Œå°±é¿å…äº†æ“ä½œå‘˜ B ç”¨åŸºäº version=1 çš„æ—§æ•°æ®ä¿®æ”¹çš„ç»“æœè¦†ç›–æ“ä½œå‘˜A çš„æ“ä½œç»“æœçš„å¯èƒ½ã€‚</p>
<h3 id="2-éé˜»å¡ç®—æ³•ï¼ˆnon-blocking-algorithmï¼‰"><a href="#2-éé˜»å¡ç®—æ³•ï¼ˆnon-blocking-algorithmï¼‰" class="headerlink" title="2 éé˜»å¡ç®—æ³•ï¼ˆnon-blocking algorithmï¼‰"></a>2 éé˜»å¡ç®—æ³•ï¼ˆnon-blocking algorithmï¼‰</h3><p>// TODO</p>
<ul>
<li>Wait-freedom</li>
<li>Lock-freedom</li>
<li>Obstruction-freedom</li>
</ul>
<h4 id="éé˜»å¡ç®—æ³•çš„å¥½å¤„"><a href="#éé˜»å¡ç®—æ³•çš„å¥½å¤„" class="headerlink" title="éé˜»å¡ç®—æ³•çš„å¥½å¤„"></a>éé˜»å¡ç®—æ³•çš„å¥½å¤„</h4><p>There are several benefits of non-blocking algorithms compared to blocking algorithms. This section will describe these benefits.</p>
<h5 id="Choice"><a href="#Choice" class="headerlink" title="Choice"></a>Choice</h5><p>The first benefit of non-blocking algorithms is, that threads are given a choice about what to do when their requested action cannot be performed. Instead of just being blocked, the request thread has a choice about what to do. Sometimes there is nothing a thread can do. In that case it can choose to block or wait itself, thus freeing up the CPU for other tasks. But at least the requesting thread is given a choice.</p>
<p>On a single CPU system perhaps it makes sense to suspend a thread that cannot perform a desired action, and let other threads which can perform their work run on the CPU. But even on a single CPU system blocking algorithms may lead to problems like <a href="http://tutorials.jenkov.com/java-concurrency/deadlock.html" target="_blank" rel="noopener">deadlock</a>, <a href="http://tutorials.jenkov.com/java-concurrency/starvation-and-fairness.html" target="_blank" rel="noopener">starvation</a> and other concurrency problems.</p>
<h5 id="No-Deadlocks"><a href="#No-Deadlocks" class="headerlink" title="No Deadlocks"></a>No Deadlocks</h5><p>The second benefit of non-blocking algorithms is, that the suspension of one thread cannot lead to the suspension of other threads. This means that deadlock cannot occur. Two threads cannot be blocked waiting for each other to release a lock they want. Since threads are not blocked when they cannot perform their requested action, they cannot be blocked waiting for each other. Non-blocking algorithms may still result in live lock, where two threads keep attempting some action, but keep being told that it is not possible (because of the actions of the other thread).</p>
<h5 id="No-Thread-Suspension"><a href="#No-Thread-Suspension" class="headerlink" title="No Thread Suspension"></a>No Thread Suspension</h5><p>Suspending and reactivating a thread is costly. Yes, the costs of suspension and reactivation has gone down over time as operating systems and thread libraries become more efficient. However, there is still a high price to pay for thread suspension and reactivation.</p>
<p>Whenever a thread is blocked it is suspended, thus incurring the overhead of thread suspension and reactivation. Since threads are not suspended by non-blocking algorithms, this overhead does not occur. This means that the CPUs can potentially spend more time performing actual business logic instead of context switching.</p>
<p>On a multi CPU system blocking algorithms can have more significant impact on the overall performance. A thread running on CPU A can be blocked waiting for a thread running on CPU B. This lowers the level of parallelism the application is capable of achieving. Of course, CPU A could just schedule another thread to run, but suspending and activating threads (context switches) are expensive. The less threads need to be suspended the better.</p>
<h5 id="Reduced-Thread-Latency"><a href="#Reduced-Thread-Latency" class="headerlink" title="Reduced Thread Latency"></a>Reduced Thread Latency</h5><p>Latency in this context means the time between a requested action becomes possible and the thread actually performs it. Since threads are not suspended in non-blocking algorithms they do not have to pay the expensive, slow reactivation overhead. That means that when a requested action becomes possible threads can respond faster and thus reduce their response latency.</p>
<p>The non-blocking algorithms often obtain the lower latency by busy-waiting until the requested action becomes possible. Of course, in a system with high thread contention on the non-blocking data structure, CPUs may end up burning a lot of cycles during these busy waits. This is a thing to keep in mind. Non-blocking algorithms may not be the best if your data structure has high thread contention. However, there are often ways do redesign your application to have less thread contention.</p>
<h4 id="CAS-ç®—æ³•"><a href="#CAS-ç®—æ³•" class="headerlink" title="CAS ç®—æ³•"></a>CAS ç®—æ³•</h4><p>CAS å³ <strong>Compare And Swapï¼ˆæ¯”è¾ƒä¸äº¤æ¢ï¼‰</strong>ï¼Œæ˜¯ä¸€ç§æ— é”ï¼ˆLock Freeï¼‰çš„éé˜»å¡ç®—æ³•ï¼ˆNon-blocking algorithmï¼‰çš„å®ç°ã€‚ CAS ç®—æ³•æ˜¯åŸºäºä¹è§‚å¹¶å‘æ§åˆ¶æ€æƒ³çš„å®ç°ä½“ç°ã€‚</p>
<p>æ— é”åŒæ­¥ï¼ˆLock Freeï¼‰ï¼Œå³åœ¨ä¸ä½¿ç”¨é”çš„æƒ…å†µä¸‹ï¼Œå®ç°å¤šçº¿ç¨‹ä¹‹é—´çš„å˜é‡åŒæ­¥ï¼Œä¹Ÿå°±æ˜¯åœ¨æ²¡æœ‰çº¿ç¨‹è¢«é˜»å¡çš„æƒ…å†µä¸‹å®ç°å˜é‡çš„åŒæ­¥ï¼Œæ‰€ä»¥ä¹Ÿå«<strong>éé˜»å¡åŒæ­¥ï¼ˆNon-blocking Synchronizationï¼‰</strong>ã€‚</p>
<p>æ³¨æ„ï¼Œæ— é”ï¼ˆlock-freeï¼‰çš„éé˜»å¡ç®—æ³•ï¼ˆnonblocking algorithmsï¼‰æœ‰å¤šç§å®ç°æ–¹æ³•ï¼ŒCAS ç®—æ³•åªæ˜¯å…¶ä¸­çš„ä¸€ç§ã€‚</p>
<p><strong>CAS ç®—æ³•</strong>æ¶‰åŠåˆ°ä¸‰ä¸ªæ“ä½œæ•°ï¼š</p>
<ul>
<li>éœ€è¦è¯»å†™çš„å†…å­˜å€¼ V</li>
<li>è¿›è¡Œæ¯”è¾ƒçš„å€¼ A</li>
<li>æ‹Ÿå†™å…¥çš„æ–°å€¼ B</li>
</ul>
<p>å½“ä¸”ä»…å½“ V çš„å€¼ç­‰äº A æ—¶ï¼ŒCAS é€šè¿‡åŸå­æ–¹å¼ç”¨æ–°å€¼Bæ¥æ›´æ–°Vçš„å€¼ï¼Œå¦åˆ™ä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œï¼ˆæ¯”è¾ƒå’Œæ›¿æ¢æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼‰ã€‚ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ä¸€ä¸ª<strong>è‡ªæ—‹æ“ä½œ</strong>ï¼Œå³<strong>ä¸æ–­çš„é‡è¯•</strong>ã€‚</p>
<p>CAS ç®—æ³•é€šè¿‡ CPU æŒ‡ä»¤é›†ä¿è¯åŸå­æ€§ï¼ˆatomicityï¼‰ï¼Œå› æ­¤ä¸éœ€è¦è¿›è¡Œç”¨æˆ·æ€ï¼ˆuser modeï¼‰å’Œå†…æ ¸æ€ï¼ˆkernel modeï¼‰çš„åˆ‡æ¢ï¼Œä¹Ÿä¸éœ€è¦è¿›è¡Œçº¿ç¨‹çš„åˆ‡æ¢ã€‚</p>
<p>è¿™å…¶å®å’Œä¹è§‚é”çš„å†²çªæ£€æŸ¥+æ•°æ®æ›´æ–°çš„åŸç†æ˜¯ä¸€æ ·çš„ã€‚</p>
<h2 id="ä¹è§‚å¹¶å‘æ§åˆ¶çš„ç¼ºç‚¹"><a href="#ä¹è§‚å¹¶å‘æ§åˆ¶çš„ç¼ºç‚¹" class="headerlink" title="ä¹è§‚å¹¶å‘æ§åˆ¶çš„ç¼ºç‚¹"></a>ä¹è§‚å¹¶å‘æ§åˆ¶çš„ç¼ºç‚¹</h2><h3 id="ABA-é—®é¢˜"><a href="#ABA-é—®é¢˜" class="headerlink" title="ABA é—®é¢˜"></a>ABA é—®é¢˜</h3><p>æ¯”å¦‚è¯´ä¸€ä¸ªçº¿ç¨‹ <code>T1</code> ä»å†…å­˜ä½ç½®<code>V</code>ä¸­å–å‡º <code>A</code> ï¼Œè¿™æ—¶å€™å¦ä¸€ä¸ªçº¿ç¨‹<code>T2</code>ä¹Ÿä»å†…å­˜ä¸­å–å‡º <code>A</code> ï¼Œå¹¶ä¸” <code>T2</code> è¿›è¡Œäº†ä¸€äº›æ“ä½œå˜æˆäº† <code>B</code> ï¼Œç„¶å <code>T2</code> åˆå°† <code>V</code> ä½ç½®çš„æ•°æ®å˜æˆ <code>A</code>ï¼Œè¿™æ—¶å€™çº¿ç¨‹ <code>T1</code> è¿›è¡Œ <code>CAS</code> æ“ä½œå‘ç°å†…å­˜ä¸­ä»ç„¶æ˜¯ <code>A</code> ï¼Œç„¶å <code>T1</code> æ“ä½œæˆåŠŸã€‚å°½ç®¡çº¿ç¨‹ <code>T1</code> çš„ <code>CAS</code> æ“ä½œæˆåŠŸï¼Œä½†å¯èƒ½å­˜åœ¨æ½œåœ¨çš„é—®é¢˜ã€‚</p>
<p>ä¸€ä¸ªé€šå¸¸çš„è§£å†³ ABA é—®é¢˜çš„æ€è·¯æ˜¯å¢åŠ æ—¶é—´æˆ³ï¼Œå³åœ¨è¿›è¡Œæ•°æ®æ›´æ–°æ—¶ï¼Œä¸ä»…ä»…å¯¹æ¯”å½“å‰å€¼ä¸å¼€å§‹æ“ä½œä¹‹å‰çš„å€¼æ˜¯ä¸æ˜¯ä¸€è‡´ï¼Œè¿˜å¯¹æ¯”æœ€åä¿®æ”¹æ•°æ®çš„æ—¶é—´æˆ³æ˜¯å¦ä¸€è‡´ã€‚</p>
<h3 id="å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§"><a href="#å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§" class="headerlink" title="å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§"></a>å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§</h3><p>è‡ªæ—‹ <code>CAS</code>ï¼ˆä¸æˆåŠŸï¼Œå°±ä¸€ç›´å¾ªç¯æ‰§è¡Œï¼Œç›´åˆ°æˆåŠŸï¼‰å¦‚æœé•¿æ—¶é—´ä¸æˆåŠŸï¼Œä¼šç»™ CPU å¸¦æ¥éå¸¸å¤§çš„æ‰§è¡Œå¼€é”€ã€‚</p>
<p>å¦‚æœ <code>JVM</code> èƒ½æ”¯æŒå¤„ç†å™¨æä¾›çš„ <code>pause</code> æŒ‡ä»¤é‚£ä¹ˆæ•ˆç‡ä¼šæœ‰ä¸€å®šçš„æå‡ï¼Œ<code>pause</code> æŒ‡ä»¤æœ‰ä¸¤ä¸ªä½œç”¨ï¼š</p>
<ul>
<li>å®ƒå¯ä»¥å»¶è¿Ÿæµæ°´çº¿æ‰§è¡ŒæŒ‡ä»¤ï¼ˆ<code>de-pipeline</code>ï¼‰ï¼Œä½¿<code>CPU</code>ä¸ä¼šæ¶ˆè€—è¿‡å¤šçš„æ‰§è¡Œèµ„æºï¼Œå»¶è¿Ÿçš„æ—¶é—´å–å†³äºå…·ä½“å®ç°çš„ç‰ˆæœ¬ï¼Œåœ¨ä¸€äº›å¤„ç†å™¨ä¸Šå»¶è¿Ÿæ—¶é—´æ˜¯é›¶ã€‚</li>
<li>å®ƒå¯ä»¥é¿å…åœ¨é€€å‡ºå¾ªç¯çš„æ—¶å€™å› å†…å­˜é¡ºåºå†²çªï¼ˆ<code>memory order violation</code>ï¼‰è€Œå¼•èµ·CPUæµæ°´çº¿è¢«æ¸…ç©ºï¼ˆ<code>CPU pipeline flush</code>ï¼‰ï¼Œä»è€Œæé«˜<code>CPU</code>çš„æ‰§è¡Œæ•ˆç‡ã€‚</li>
</ul>
<h3 id="åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ"><a href="#åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ" class="headerlink" title="åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ"></a>åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œ</h3><p>å½“å¯¹ä¸€ä¸ªå…±äº«å˜é‡æ‰§è¡Œæ“ä½œæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¾ªç¯ CAS çš„æ–¹å¼æ¥ä¿è¯åŸå­æ“ä½œï¼Œä½†æ˜¯å¯¹å¤šä¸ªå…±äº«å˜é‡æ“ä½œæ—¶ï¼Œå¾ªç¯ CAS å°±æ— æ³•ä¿è¯æ“ä½œçš„åŸå­æ€§ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨é”ï¼Œæˆ–è€…æœ‰ä¸€ä¸ªå–å·§çš„åŠæ³•ï¼Œå°±æ˜¯æŠŠå¤šä¸ªå…±äº«å˜é‡åˆå¹¶æˆä¸€ä¸ªå…±äº«å˜é‡æ¥æ“ä½œã€‚æ¯”å¦‚æœ‰ä¸¤ä¸ªå…±äº«å˜é‡ <code>i ï¼ 2,j = a</code> ï¼Œåˆå¹¶ä¸€ä¸‹ <code>ij = 2a</code> ï¼Œç„¶åç”¨ <code>CAS</code> æ¥æ“ä½œ ijã€‚ä» <code>Java 1.5</code> å¼€å§‹ JDK æä¾›äº† <code>AtomicReference</code> ç±»æ¥ä¿è¯å¼•ç”¨å¯¹è±¡ä¹‹é—´çš„åŸå­æ€§ï¼Œä½ å¯ä»¥æŠŠå¤šä¸ªå˜é‡æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œæ¥è¿›è¡Œ <code>CAS</code> æ“ä½œã€‚</p>
<h1 id="ä¹è§‚å¹¶å‘æ§åˆ¶çš„-CAS-ä¸æ‚²è§‚å¹¶å‘æ§åˆ¶çš„-Java-synchronized-å…³é”®å­—çš„ä½¿ç”¨æƒ…æ™¯"><a href="#ä¹è§‚å¹¶å‘æ§åˆ¶çš„-CAS-ä¸æ‚²è§‚å¹¶å‘æ§åˆ¶çš„-Java-synchronized-å…³é”®å­—çš„ä½¿ç”¨æƒ…æ™¯" class="headerlink" title="ä¹è§‚å¹¶å‘æ§åˆ¶çš„ CAS ä¸æ‚²è§‚å¹¶å‘æ§åˆ¶çš„ Java synchronized å…³é”®å­—çš„ä½¿ç”¨æƒ…æ™¯"></a>ä¹è§‚å¹¶å‘æ§åˆ¶çš„ CAS ä¸æ‚²è§‚å¹¶å‘æ§åˆ¶çš„ Java synchronized å…³é”®å­—çš„ä½¿ç”¨æƒ…æ™¯</h1><p>ç»“è®ºå…ˆè¡Œï¼š<strong>CAS é€‚ç”¨äºå†™æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ˆå¤šè¯»åœºæ™¯ï¼Œå†²çªä¸€èˆ¬è¾ƒå°‘ï¼‰ï¼ŒJava çš„ synchronized å…³é”®å­—é€‚ç”¨äºå†™æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼ˆå¤šå†™åœºæ™¯ï¼Œå†²çªä¸€èˆ¬è¾ƒå¤šï¼‰</strong>ã€‚</p>
<ul>
<li>å¯¹äºèµ„æºç«äº‰è¾ƒå°‘ï¼ˆçº¿ç¨‹å†²çªè¾ƒè½»ï¼‰çš„æƒ…å†µï¼Œä½¿ç”¨ synchronized åŒæ­¥é”è¿›è¡Œçº¿ç¨‹é˜»å¡å’Œå”¤é†’åˆ‡æ¢ä»¥åŠç”¨æˆ·æ€å†…æ ¸æ€é—´çš„åˆ‡æ¢æ“ä½œé¢å¤–æµªè´¹æ¶ˆè€— CPU èµ„æºï¼›è€Œ CAS åŸºäº CPU æŒ‡ä»¤é›†å®ç°ï¼Œä¸éœ€è¦è¿›å…¥å†…æ ¸ï¼Œä¸éœ€è¦åˆ‡æ¢çº¿ç¨‹ï¼Œæ“ä½œè‡ªæ—‹å‡ ç‡è¾ƒå°‘ï¼Œå› æ­¤å¯ä»¥è·å¾—æ›´é«˜çš„æ€§èƒ½ã€‚</li>
<li>å¯¹äºèµ„æºç«äº‰ä¸¥é‡ï¼ˆçº¿ç¨‹å†²çªä¸¥é‡ï¼‰çš„æƒ…å†µï¼ŒCAS è‡ªæ—‹çš„æ¦‚ç‡ä¼šæ¯”è¾ƒå¤§ï¼Œä»è€Œæµªè´¹æ›´å¤šçš„ CPU èµ„æºï¼Œæ•ˆç‡ä½äº synchronizedã€‚</li>
</ul>
<p>è¡¥å……ï¼š Java å¹¶å‘ç¼–ç¨‹è¿™ä¸ªé¢†åŸŸä¸­ synchronized å…³é”®å­—ä¸€ç›´éƒ½æ˜¯å…ƒè€çº§çš„è§’è‰²ï¼Œå¾ˆä¹…ä¹‹å‰å¾ˆå¤šäººéƒ½ä¼šç§°å®ƒä¸º <strong>â€œé‡é‡çº§é”â€</strong> ã€‚ä½†æ˜¯ï¼Œåœ¨ JavaSE 1.6 ä¹‹åè¿›è¡Œäº†ä¸»è¦åŒ…æ‹¬ä¸ºäº†å‡å°‘è·å¾—é”å’Œé‡Šæ”¾é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—è€Œå¼•å…¥çš„ <strong>åå‘é”</strong> å’Œ <strong>è½»é‡çº§é”</strong> ä»¥åŠå…¶å®ƒ<strong>å„ç§ä¼˜åŒ–</strong>ä¹‹åå˜å¾—åœ¨æŸäº›æƒ…å†µä¸‹å¹¶ä¸æ˜¯é‚£ä¹ˆé‡äº†ã€‚</p>
<p>synchronized çš„åº•å±‚å®ç°ä¸»è¦ä¾é  <strong>Lock-Free</strong> çš„é˜Ÿåˆ—ï¼ŒåŸºæœ¬æ€è·¯æ˜¯<strong>è‡ªæ—‹åé˜»å¡</strong>ï¼Œ<strong>ç«äº‰åˆ‡æ¢åç»§ç»­ç«äº‰é”</strong>ï¼Œ<strong>ç¨å¾®ç‰ºç‰²äº†å…¬å¹³æ€§ï¼Œä½†è·å¾—äº†é«˜ååé‡</strong>ã€‚åœ¨çº¿ç¨‹å†²çªè¾ƒå°‘çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è·å¾—å’Œ CAS ç±»ä¼¼çš„æ€§èƒ½ï¼›è€Œçº¿ç¨‹å†²çªä¸¥é‡çš„æƒ…å†µä¸‹ï¼Œæ€§èƒ½è¿œé«˜äº CAS ã€‚</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li>ã€ŠModern Operating System 4thã€‹</li>
<li><a href="https://en.wikipedia.org/wiki/Concurrency_control#Concurrency_control_in_operating_systems" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Concurrency_control#Concurrency_control_in_operating_systems</a></li>
<li><a href="https://en.wikipedia.org/wiki/Non-blocking_algorithm" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Non-blocking_algorithm</a></li>
<li><a href="https://en.wikipedia.org/wiki/Compare-and-swap" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Compare-and-swap</a></li>
<li><a href="https://www.cs.cmu.edu/~410-s05/lectures/L31_LockFree.pdf" target="_blank" rel="noopener">https://www.cs.cmu.edu/~410-s05/lectures/L31_LockFree.pdf</a></li>
<li><a href="https://en.wikipedia.org/wiki/Multiversion_concurrency_control" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Multiversion_concurrency_control</a></li>
<li><a href="https://en.wikipedia.org/wiki/Optimistic_concurrency_control" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Optimistic_concurrency_control</a></li>
<li><a href="http://tutorials.jenkov.com/java-concurrency/non-blocking-algorithms.html" target="_blank" rel="noopener">http://tutorials.jenkov.com/java-concurrency/non-blocking-algorithms.html</a></li>
<li><a href="https://preshing.com/20120612/an-introduction-to-lock-free-programming/" target="_blank" rel="noopener">https://preshing.com/20120612/an-introduction-to-lock-free-programming/</a></li>
<li>é¢è¯•å¿…å¤‡ä¹‹ä¹è§‚é”ä¸æ‚²è§‚é” - <a href="https://juejin.im/post/5b4977ae5188251b146b2fc8" target="_blank" rel="noopener">https://juejin.im/post/5b4977ae5188251b146b2fc8</a></li>
<li>ä¹è§‚é”ã€æ‚²è§‚é”ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼- <a href="https://segmentfault.com/a/1190000016611415" target="_blank" rel="noopener">https://segmentfault.com/a/1190000016611415</a></li>
</ul>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">Operating System</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/OperatingSystem/" class="article-tag-list-link color1">OperatingSystem</a>
        		</li>
      		
		</ul>
	</div>


      

      
        
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <div class="wx-qrcode">
   
    </div>
</div>

<div class="mask js-mask"></div>
      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
    <a href="/2019/02/19/ã€Programmingã€‘å¹¶å‘ç¼–ç¨‹/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          ã€Programmingã€‘å¹¶å‘ç¼–ç¨‹ï¼ˆConcurrent Programmingï¼‰
        
      </div>
    </a>
  
  
    <a href="/2019/02/14/ã€Operating-Systemã€‘è¿›ç¨‹-è¿›ç¨‹ä¸çº¿ç¨‹/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">ã€Operating Systemã€‘è¿›ç¨‹ - è¿›ç¨‹ä¸çº¿ç¨‹</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>






  
    <div class="duoshuo"></div>
  




          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2020 è¥¿ç»´èœ€é»
    	</div>
      	<div class="footer-right">
      		
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: true,
		root: "/",
		innerArchive: true,
		showTags: true
	}
</script>

<script>!function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="./",n(0)}([function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){var e=/\/|index.html/g;return t.replace(e,"")===n.replace(e,"")}function i(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,e=0,r=t.length;e<r;e++){var i=t[e];o(n,i.getAttribute("href"))&&(0,d.default)(i,"active")}}function u(t){for(var n=t.offsetLeft,e=t.offsetParent;null!==e;)n+=e.offsetLeft,e=e.offsetParent;return n}function f(t){for(var n=t.offsetTop,e=t.offsetParent;null!==e;)n+=e.offsetTop,e=e.offsetParent;return n}function c(t,n,e,r,o){var i=u(t),c=f(t)-n;if(c-e<=o){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,h.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(e||c)+"px",a.style.left=i+"px",a.style.zIndex=r||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");c(t,document.body.scrollTop,-63,2,0),c(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}function l(){x.default.versions.mobile&&window.screen.width<800&&(i(),s())}var p=e(71),d=r(p),v=e(72),y=(r(v),e(84)),h=r(y),b=e(69),x=r(b),m=e(75),g=r(m),w=e(70);l(),(0,w.addLoadEvent)(function(){g.default.init()}),t.exports={}},function(t,n){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t,n){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},function(t,n,e){var r=e(49),o=e(15);t.exports=function(t){return r(o(t))}},function(t,n,e){t.exports=!e(8)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,e){var r=e(6),o=e(12);t.exports=e(4)?function(t,n,e){return r.f(t,n,o(1,e))}:function(t,n,e){return t[n]=e,t}},function(t,n,e){var r=e(10),o=e(30),i=e(24),u=Object.defineProperty;n.f=e(4)?Object.defineProperty:function(t,n,e){if(r(t),n=i(n,!0),r(e),o)try{return u(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},function(t,n,e){var r=e(22)("wks"),o=e(13),i=e(1).Symbol,u="function"==typeof i,f=t.exports=function(t){return r[t]||(r[t]=u&&i[t]||(u?i:o)("Symbol."+t))};f.store=r},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,e){var r=e(35),o=e(16);t.exports=Object.keys||function(t){return r(t,o)}},function(t,n,e){var r=e(11);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var e=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+r).toString(36))}},function(t,n){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,e){var r=e(6).f,o=e(2),i=e(7)("toStringTag");t.exports=function(t,n,e){t&&!o(t=e?t:t.prototype,i)&&r(t,i,{configurable:!0,value:n})}},function(t,n,e){var r=e(22)("keys"),o=e(13);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,n,e){var r=e(1),o="__core-js_shared__",i=r[o]||(r[o]={});t.exports=function(t){return i[t]||(i[t]={})}},function(t,n){var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},function(t,n,e){var r=e(11);t.exports=function(t,n){if(!r(t))return t;var e,o;if(n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;if("function"==typeof(e=t.valueOf)&&!r(o=e.call(t)))return o;if(!n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,n,e){var r=e(1),o=e(14),i=e(18),u=e(26),f=e(6).f;t.exports=function(t){var n=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==t.charAt(0)||t in n||f(n,t,{value:u.f(t)})}},function(t,n,e){n.f=e(7)},function(t,n,e){var r=e(1),o=e(14),i=e(46),u=e(5),f="prototype",c=function(t,n,e){var a,s,l,p=t&c.F,d=t&c.G,v=t&c.S,y=t&c.P,h=t&c.B,b=t&c.W,x=d?o:o[n]||(o[n]={}),m=x[f],g=d?r:v?r[n]:(r[n]||{})[f];d&&(e=n);for(a in e)s=!p&&g&&void 0!==g[a],s&&a in x||(l=s?g[a]:e[a],x[a]=d&&"function"!=typeof g[a]?e[a]:h&&s?i(l,r):b&&g[a]==l?function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n[f]=t[f],n}(l):y&&"function"==typeof l?i(Function.call,l):l,y&&((x.virtual||(x.virtual={}))[a]=l,t&c.R&&m&&!m[a]&&u(m,a,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,n){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t,n,e){var r=e(11),o=e(1).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,n,e){t.exports=!e(4)&&!e(8)(function(){return 7!=Object.defineProperty(e(29)("div"),"a",{get:function(){return 7}}).a})},function(t,n,e){"use strict";var r=e(18),o=e(27),i=e(36),u=e(5),f=e(2),c=e(17),a=e(51),s=e(20),l=e(58),p=e(7)("iterator"),d=!([].keys&&"next"in[].keys()),v="@@iterator",y="keys",h="values",b=function(){return this};t.exports=function(t,n,e,x,m,g,w){a(e,n,x);var O,S,_,j=function(t){if(!d&&t in A)return A[t];switch(t){case y:return function(){return new e(this,t)};case h:return function(){return new e(this,t)}}return function(){return new e(this,t)}},P=n+" Iterator",E=m==h,M=!1,A=t.prototype,T=A[p]||A[v]||m&&A[m],L=T||j(m),N=m?E?j("entries"):L:void 0,C="Array"==n?A.entries||T:T;if(C&&(_=l(C.call(new t)),_!==Object.prototype&&(s(_,P,!0),r||f(_,p)||u(_,p,b))),E&&T&&T.name!==h&&(M=!0,L=function(){return T.call(this)}),r&&!w||!d&&!M&&A[p]||u(A,p,L),c[n]=L,c[P]=b,m)if(O={values:E?L:j(h),keys:g?L:j(y),entries:N},w)for(S in O)S in A||i(A,S,O[S]);else o(o.P+o.F*(d||M),n,O);return O}},function(t,n,e){var r=e(10),o=e(55),i=e(16),u=e(21)("IE_PROTO"),f=function(){},c="prototype",a=function(){var t,n=e(29)("iframe"),r=i.length,o="<",u=">";for(n.style.display="none",e(48).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write(o+"script"+u+"document.F=Object"+o+"/script"+u),t.close(),a=t.F;r--;)delete a[c][i[r]];return a()};t.exports=Object.create||function(t,n){var e;return null!==t?(f[c]=r(t),e=new f,f[c]=null,e[u]=t):e=a(),void 0===n?e:o(e,n)}},function(t,n,e){var r=e(35),o=e(16).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,e){var r=e(2),o=e(3),i=e(45)(!1),u=e(21)("IE_PROTO");t.exports=function(t,n){var e,f=o(t),c=0,a=[];for(e in f)e!=u&&r(f,e)&&a.push(e);for(;n.length>c;)r(f,e=n[c++])&&(~i(a,e)||a.push(e));return a}},function(t,n,e){t.exports=e(5)},function(t,n,e){var r=e(15);t.exports=function(t){return Object(r(t))}},function(t,n,e){t.exports={default:e(41),__esModule:!0}},function(t,n,e){t.exports={default:e(42),__esModule:!0}},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var o=e(39),i=r(o),u=e(38),f=r(u),c="function"==typeof f.default&&"symbol"==typeof i.default?function(t){return typeof t}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":typeof t};n.default="function"==typeof f.default&&"symbol"===c(i.default)?function(t){return"undefined"==typeof t?"undefined":c(t)}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":"undefined"==typeof t?"undefined":c(t)}},function(t,n,e){e(65),e(63),e(66),e(67),t.exports=e(14).Symbol},function(t,n,e){e(64),e(68),t.exports=e(26).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,e){var r=e(3),o=e(61),i=e(60);t.exports=function(t){return function(n,e,u){var f,c=r(n),a=o(c.length),s=i(u,a);if(t&&e!=e){for(;a>s;)if(f=c[s++],f!=f)return!0}else for(;a>s;s++)if((t||s in c)&&c[s]===e)return t||s||0;return!t&&-1}}},function(t,n,e){var r=e(43);t.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)}}return function(){return t.apply(n,arguments)}}},function(t,n,e){var r=e(9),o=e(34),i=e(19);t.exports=function(t){var n=r(t),e=o.f;if(e)for(var u,f=e(t),c=i.f,a=0;f.length>a;)c.call(t,u=f[a++])&&n.push(u);return n}},function(t,n,e){t.exports=e(1).document&&document.documentElement},function(t,n,e){var r=e(28);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,n,e){var r=e(28);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,n,e){"use strict";var r=e(32),o=e(12),i=e(20),u={};e(5)(u,e(7)("iterator"),function(){return this}),t.exports=function(t,n,e){t.prototype=r(u,{next:o(1,e)}),i(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,e){var r=e(9),o=e(3);t.exports=function(t,n){for(var e,i=o(t),u=r(i),f=u.length,c=0;f>c;)if(i[e=u[c++]]===n)return e}},function(t,n,e){var r=e(13)("meta"),o=e(11),i=e(2),u=e(6).f,f=0,c=Object.isExtensible||function(){return!0},a=!e(8)(function(){return c(Object.preventExtensions({}))}),s=function(t){u(t,r,{value:{i:"O"+ ++f,w:{}}})},l=function(t,n){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,r)){if(!c(t))return"F";if(!n)return"E";s(t)}return t[r].i},p=function(t,n){if(!i(t,r)){if(!c(t))return!0;if(!n)return!1;s(t)}return t[r].w},d=function(t){return a&&v.NEED&&c(t)&&!i(t,r)&&s(t),t},v=t.exports={KEY:r,NEED:!1,fastKey:l,getWeak:p,onFreeze:d}},function(t,n,e){var r=e(6),o=e(10),i=e(9);t.exports=e(4)?Object.defineProperties:function(t,n){o(t);for(var e,u=i(n),f=u.length,c=0;f>c;)r.f(t,e=u[c++],n[e]);return t}},function(t,n,e){var r=e(19),o=e(12),i=e(3),u=e(24),f=e(2),c=e(30),a=Object.getOwnPropertyDescriptor;n.f=e(4)?a:function(t,n){if(t=i(t),n=u(n,!0),c)try{return a(t,n)}catch(t){}if(f(t,n))return o(!r.f.call(t,n),t[n])}},function(t,n,e){var r=e(3),o=e(33).f,i={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(t){try{return o(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==i.call(t)?f(t):o(r(t))}},function(t,n,e){var r=e(2),o=e(37),i=e(21)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,e){var r=e(23),o=e(15);t.exports=function(t){return function(n,e){var i,u,f=String(o(n)),c=r(e),a=f.length;return c<0||c>=a?t?"":void 0:(i=f.charCodeAt(c),i<55296||i>56319||c+1===a||(u=f.charCodeAt(c+1))<56320||u>57343?t?f.charAt(c):i:t?f.slice(c,c+2):(i-55296<<10)+(u-56320)+65536)}}},function(t,n,e){var r=e(23),o=Math.max,i=Math.min;t.exports=function(t,n){return t=r(t),t<0?o(t+n,0):i(t,n)}},function(t,n,e){var r=e(23),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,n,e){"use strict";var r=e(44),o=e(52),i=e(17),u=e(3);t.exports=e(31)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,e=this._i++;return!t||e>=t.length?(this._t=void 0,o(1)):"keys"==n?o(0,e):"values"==n?o(0,t[e]):o(0,[e,t[e]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(t,n){},function(t,n,e){"use strict";var r=e(59)(!0);e(31)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,e=this._i;return e>=n.length?{value:void 0,done:!0}:(t=r(n,e),this._i+=t.length,{value:t,done:!1})})},function(t,n,e){"use strict";var r=e(1),o=e(2),i=e(4),u=e(27),f=e(36),c=e(54).KEY,a=e(8),s=e(22),l=e(20),p=e(13),d=e(7),v=e(26),y=e(25),h=e(53),b=e(47),x=e(50),m=e(10),g=e(3),w=e(24),O=e(12),S=e(32),_=e(57),j=e(56),P=e(6),E=e(9),M=j.f,A=P.f,T=_.f,L=r.Symbol,N=r.JSON,C=N&&N.stringify,k="prototype",F=d("_hidden"),q=d("toPrimitive"),I={}.propertyIsEnumerable,B=s("symbol-registry"),D=s("symbols"),W=s("op-symbols"),H=Object[k],K="function"==typeof L,R=r.QObject,J=!R||!R[k]||!R[k].findChild,U=i&&a(function(){return 7!=S(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a})?function(t,n,e){var r=M(H,n);r&&delete H[n],A(t,n,e),r&&t!==H&&A(H,n,r)}:A,G=function(t){var n=D[t]=S(L[k]);return n._k=t,n},$=K&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},z=function(t,n,e){return t===H&&z(W,n,e),m(t),n=w(n,!0),m(e),o(D,n)?(e.enumerable?(o(t,F)&&t[F][n]&&(t[F][n]=!1),e=S(e,{enumerable:O(0,!1)})):(o(t,F)||A(t,F,O(1,{})),t[F][n]=!0),U(t,n,e)):A(t,n,e)},Y=function(t,n){m(t);for(var e,r=b(n=g(n)),o=0,i=r.length;i>o;)z(t,e=r[o++],n[e]);return t},Q=function(t,n){return void 0===n?S(t):Y(S(t),n)},X=function(t){var n=I.call(this,t=w(t,!0));return!(this===H&&o(D,t)&&!o(W,t))&&(!(n||!o(this,t)||!o(D,t)||o(this,F)&&this[F][t])||n)},V=function(t,n){if(t=g(t),n=w(n,!0),t!==H||!o(D,n)||o(W,n)){var e=M(t,n);return!e||!o(D,n)||o(t,F)&&t[F][n]||(e.enumerable=!0),e}},Z=function(t){for(var n,e=T(g(t)),r=[],i=0;e.length>i;)o(D,n=e[i++])||n==F||n==c||r.push(n);return r},tt=function(t){for(var n,e=t===H,r=T(e?W:g(t)),i=[],u=0;r.length>u;)!o(D,n=r[u++])||e&&!o(H,n)||i.push(D[n]);return i};K||(L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),n=function(e){this===H&&n.call(W,e),o(this,F)&&o(this[F],t)&&(this[F][t]=!1),U(this,t,O(1,e))};return i&&J&&U(H,t,{configurable:!0,set:n}),G(t)},f(L[k],"toString",function(){return this._k}),j.f=V,P.f=z,e(33).f=_.f=Z,e(19).f=X,e(34).f=tt,i&&!e(18)&&f(H,"propertyIsEnumerable",X,!0),v.f=function(t){return G(d(t))}),u(u.G+u.W+u.F*!K,{Symbol:L});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;nt.length>et;)d(nt[et++]);for(var nt=E(d.store),et=0;nt.length>et;)y(nt[et++]);u(u.S+u.F*!K,"Symbol",{for:function(t){return o(B,t+="")?B[t]:B[t]=L(t)},keyFor:function(t){if($(t))return h(B,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){J=!0},useSimple:function(){J=!1}}),u(u.S+u.F*!K,"Object",{create:Q,defineProperty:z,defineProperties:Y,getOwnPropertyDescriptor:V,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),N&&u(u.S+u.F*(!K||a(function(){var t=L();return"[null]"!=C([t])||"{}"!=C({a:t})||"{}"!=C(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!$(t)){for(var n,e,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);return n=r[1],"function"==typeof n&&(e=n),!e&&x(n)||(n=function(t,n){if(e&&(n=e.call(this,t,n)),!$(n))return n}),r[1]=n,C.apply(N,r)}}}),L[k][q]||e(5)(L[k],q,L[k].valueOf),l(L,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},function(t,n,e){e(25)("asyncIterator")},function(t,n,e){e(25)("observable")},function(t,n,e){e(62);for(var r=e(1),o=e(5),i=e(17),u=e(7)("toStringTag"),f=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],c=0;c<5;c++){var a=f[c],s=r[a],l=s&&s.prototype;l&&!l[u]&&o(l,u,a),i[a]=i.Array}},function(t,n){"use strict";var e={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&t.indexOf("KHTML")==-1,mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:t.indexOf("Safari")==-1,weixin:t.indexOf("MicroMessenger")==-1}}()};t.exports=e},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=e(40),i=r(o),u=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):o[t]||t}function n(t){return l[t]}var e=/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,r=/['<> "&]/g,o={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},f=/\u00a0/g,c=/<br\s*\/?>/gi,a=/\r?\n/g,s=/\s/g,l={};for(var p in o)l[o[p]]=p;return o["&apos;"]="'",l["'"]="&#39;",{encode:function(t){return t?(""+t).replace(r,n).replace(a,"<br/>").replace(s,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(c,"\n").replace(e,t).replace(f," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e+=2)n.push(String.fromCharCode("0x"+t.slice(e,e+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,e=t.length;e>n;n++)t[n]=u.encodeObject(t[n]);else if("object"==("undefined"==typeof t?"undefined":(0,i.default)(t)))for(var r in t)t[r]=u.encodeObject(t[r]);else if("string"==typeof t)return u.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=u},function(t,n){function e(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=e},function(t,n){function e(t,n){if(t.classList)t.classList.remove(n);else{var e=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(e," ")}}t.exports=e},,,function(t,n){"use strict";function e(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){var n=document.querySelectorAll(".article-entry a:not(.article-more-a)");n.forEach(function(t){t.setAttribute("target","_blank")})}var e=document.querySelector("#js-aboutme");e&&0!==e.length&&(e.innerHTML=e.innerText)}t.exports={init:e}},,,,,,,,,function(t,n){function e(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var e=t.nextSibling;return e?t.parentNode.insertBefore(n,e):t.parentNode.appendChild(n)}t.exports=e}])</script><script src="/./main.2d7529.js"></script><script>!function(){var e=function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)};e("/slider.885efe.js")}()</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 50%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">Tag</a></li>
      
        
      
      <li style="width: 50%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">Friends</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find somethingâ€¦">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">AWS</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Algorithm Problem</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Algorithm</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Architectural Pattern</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Architecture</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">ArchitectureDesign</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Nginx</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">C#</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Frontend</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Cache</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Browser</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Debug</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Visual Studio</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Cache System</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">JavaScript</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Data Format</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Compile</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Data Structure</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Database</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Design Pattern</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Distributed System</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Django</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Redis</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Docker</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Git</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Format</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Version Control</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Golang</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Network</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">HTTP</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Hardware</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">JQuery</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Interview</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Java</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Java EE</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Software Testing</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Network Programming</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">LaTeX</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Linux</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Operating System</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Linxu</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Lock</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Markdown</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">macOS</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">MySQL</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Netwok</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Netwrok</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Node.js</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">nvm</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">NPM</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">npm</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">OOP</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">OpenWrt</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Operating Systems</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Performance</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Programming</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Protobuf</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Python</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">RaspbeeryPi</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">SQL</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Regular Expression</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Security</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Spring</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">TypeScript</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">VMware</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Vmware</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Windows</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">WordPress</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">hexo</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">iOS</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            ç¼ºå¤±æ¨¡å—ã€‚<br/>1ã€åœ¨åšå®¢æ ¹ç›®å½•ï¼ˆæ³¨æ„ä¸æ˜¯yiliaæ ¹ç›®å½•ï¼‰æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<br/> npm i hexo-generator-json-content --save<br/><br/>
            2ã€åœ¨æ ¹ç›®å½•_config.ymlé‡Œæ·»åŠ é…ç½®ï¼š
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: true
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://swsmile.info/en/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>My English Blog</a>
            </li>
          
            <li class="search-li">
              <a href="http://swsmile.info/oj/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>My OJ Blog</a>
            </li>
          
            <li class="search-li">
              <a href="http://swsmile.info/gym/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>è¥¿ç»´èœ€é»çš„å¥èº« Blog</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->



</body>
</html>